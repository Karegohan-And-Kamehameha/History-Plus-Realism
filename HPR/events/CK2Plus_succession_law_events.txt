namespace = Plus

#reserved: Plus.600 to Plus.619
#reserved: Plus.1600 to Plus.1649

#################################
# VOTING ON SUCCESSION LAW CHANGES
# Written by Wiz
# Updated by Rylock
#################################

### VOTES ON CHANGES TO FEUDAL ELECTIVE OR TANISTRY

# Liege calls de jure vassals to vote on changing the succession law
character_event = {
	id = Plus.600 #formerly 1000182996
	desc = "EVTDESC_Plus_600"
	picture = GFX_evt_council

	is_triggered_only = yes
	
	immediate = {
		random_demesne_title = {
			limit = { has_title_flag = title_to_change }
			clr_title_flag = title_to_change
			save_event_target_as = changed_title
		}
	}

	option = {
		name = "OK"
		if = {
			limit = { has_character_flag = vote_is_for_gavelkind }
			event_target:changed_title = {
				any_de_jure_vassal = {
					if = {
						limit = {
							OR = {
								AND = {
									PREV = { tier = COUNT }
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									PREV = {
										OR = {
											has_law = succ_tanistry
											has_law = succ_elective_gavelkind
										}
									}
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									PREV = {
										OR = {
											has_law = succ_tanistry
											has_law = succ_elective_gavelkind
										}
									}
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = KING
								}
							}
							OR = {
								same_realm = ROOT
								PREV = { has_law = succ_feudal_elective }
							}
							OR = {
								same_realm = ROOT
								religion = ROOT
							}
							NOT = { has_landed_title = PREV }
						}
						set_character_flag = voted_on_gavelkind
						letter_event = { id = Plus.601 days = 3 tooltip = CUSTOMTOOLTIP10 }
					}
				}
			}
		}
		if = {
			limit = { has_character_flag = vote_is_for_seniority }
			event_target:changed_title = {
				any_de_jure_vassal = {
					if = {
						limit = {
							OR = {
								AND = {
									PREV = { tier = COUNT }
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									PREV = {
										OR = {
											has_law = succ_tanistry
											has_law = succ_elective_gavelkind
										}
									}
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									PREV = {
										OR = {
											has_law = succ_tanistry
											has_law = succ_elective_gavelkind
										}
									}
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = KING
								}
							}
							OR = {
								same_realm = ROOT
								PREV = { has_law = succ_feudal_elective }
							}
							OR = {
								same_realm = ROOT
								religion = ROOT
							}
							NOT = { has_landed_title = PREV }
						}
						set_character_flag = voted_on_seniority
						letter_event = { id = Plus.603 days = 3 tooltip = CUSTOMTOOLTIP10 }
					}
				}
			}
		}
		if = {
			limit = { has_character_flag = vote_is_for_primogeniture }
			event_target:changed_title = {
				any_de_jure_vassal = {
					if = {
						limit = {
							OR = {
								AND = {
									PREV = { tier = COUNT }
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									PREV = {
										OR = {
											has_law = succ_tanistry
											has_law = succ_elective_gavelkind
										}
									}
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									PREV = {
										OR = {
											has_law = succ_tanistry
											has_law = succ_elective_gavelkind
										}
									}
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = KING
								}
							}
							OR = {
								same_realm = ROOT
								PREV = { has_law = succ_feudal_elective }
							}
							OR = {
								same_realm = ROOT
								religion = ROOT
							}
							NOT = { has_landed_title = PREV }
						}
						set_character_flag = voted_on_primogeniture
						letter_event = { id = Plus.602 days = 3 tooltip = CUSTOMTOOLTIP10 }
					}
				}
			}
		}
		if = {
			limit = { has_character_flag = vote_is_for_tanistry }
			event_target:changed_title = {
				any_de_jure_vassal = {
					if = {
						limit = {
							OR = {
								AND = {
									PREV = { tier = COUNT }
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									PREV = {
										OR = {
											has_law = succ_tanistry
											has_law = succ_elective_gavelkind
										}
									}
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									PREV = {
										OR = {
											has_law = succ_tanistry
											has_law = succ_elective_gavelkind
										}
									}
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = KING
								}
							}
							OR = {
								same_realm = ROOT
								PREV = { has_law = succ_feudal_elective }
							}
							OR = {
								same_realm = ROOT
								religion = ROOT
							}
							NOT = { has_landed_title = PREV }
						}
						set_character_flag = voted_on_tanistry
						letter_event = { id = Plus.615 days = 3 tooltip = CUSTOMTOOLTIP10 }
					}
				}
			}
		}
		if = {
			limit = { has_character_flag = vote_is_for_feudal_elective }
			event_target:changed_title = {
				any_de_jure_vassal = {
					if = {
						limit = {
							OR = {
								AND = {
									PREV = { tier = COUNT }
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									PREV = {
										OR = {
											has_law = succ_tanistry
											has_law = succ_elective_gavelkind
										}
									}
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									PREV = {
										OR = {
											has_law = succ_tanistry
											has_law = succ_elective_gavelkind
										}
									}
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = KING
								}
							}
							OR = {
								same_realm = ROOT
								PREV = { has_law = succ_feudal_elective }
							}
							OR = {
								same_realm = ROOT
								religion = ROOT
							}
							NOT = { has_landed_title = PREV }
						}
						set_character_flag = voted_on_feudal_elective
						letter_event = { id = Plus.616 days = 3 tooltip = CUSTOMTOOLTIP10 }
					}
				}
			}
		}
		hidden_tooltip = {
			character_event = {
				id = Plus.610
				days = 14
			}
		}
	}
}

# Vassals vote to approve or disapprove Gavelkind
letter_event = {
	id = Plus.601 #formerly 1000182997
	desc = "EVTDESC_Plus_601"

	is_triggered_only = yes

	option = {
		name = "EVTOPTA_Plus_601" #Approve
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10.0
				FROM = {
					reverse_opinion = { who = ROOT value = 99 }
				}
			}
			modifier = {
				factor = 5.0
				FROM = {
					reverse_opinion = { who = ROOT value = 75 }
				}
			}
			modifier = {
				factor = 2.0
				FROM = {
					reverse_opinion = { who = ROOT value = 50 }
				}
			}
			modifier = {
				factor = 0.5
				NOT = {
					FROM = {
						reverse_opinion = { who = ROOT value = 25 }
					}
				}
			}
			modifier = {
				factor = 0.01
				NOT = {
					FROM = {
						reverse_opinion = { who = ROOT value = 0 }
					}
				}
			}
			modifier = {
				factor = 0.01
				event_target:changed_title = {
					current_heir = {
						character = ROOT
						NOT = { is_child_of = FROM }
					}
				}
			}
			modifier = {
				factor = 0.5
				OR = {
					leads_faction = faction_tradition
					in_faction = faction_tradition
				}
			}
			modifier = {
				factor = 0.5
				NOT = { same_realm = FROM }
			}
			modifier = {
				factor = 0.25
				event_target:changed_title = { has_law = succ_feudal_elective }
				NOT = { dynasty = FROM }
			}
			modifier = {
				factor = 2.0
				event_target:changed_title = { has_law = succ_feudal_elective }
				OR = {
					dynasty = FROM
					is_married = FROM
				}
			}
			modifier = {
				factor = 2.0
				event_target:changed_title = { has_law = succ_elective_gavelkind }
			}
			modifier = {
				factor = 10.0
				OR = {
					is_child_of = FROM
					father = { is_child_of = FROM }
				}
			}
			modifier = {
				factor = 0.1
				is_child_of = FROM
				OR = {
					AND = {
						event_target:changed_title = {
							OR = {
								has_law = agnatic_succession
								has_law = cognatic_succession
							}
						}
						is_female = no
						any_sibling = {
							NOT = { trait = bastard }
							is_female = no
							NOT = { is_older_than = ROOT }
						}
					}
					AND = {
						event_target:changed_title = {
							OR = {
								has_law = enatic_succession
								has_law = enatic_cognatic_succession
							}
						}
						is_female = yes
						any_sibling = {
							NOT = { trait = bastard }
							is_female = yes
							NOT = { is_older_than = ROOT }
						}
					}
					AND = {
						event_target:changed_title = { has_law = true_cognatic_succession }
						any_sibling = {
							NOT = { trait = bastard }
							NOT = { is_older_than = ROOT }
						}
					}
				}
			}
			modifier = {
				factor = 0.5
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_0
							has_law = tribal_organization_0
						}
					}
				}
			}
			modifier = {
				factor = 0.75
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_1
							has_law = tribal_organization_1
						}
					}
				}
			}
			modifier = {
				factor = 1.5
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_3
							has_law = tribal_organization_3
						}
					}
				}
			}
			modifier = {
				factor = 2.0
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_4
							has_law = tribal_organization_4
						}
					}
				}
			}
		}
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = 1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_approved_succession_law
				who = ROOT
				months = 120
			}
		}
	}

	option = {
		name = "EVTOPTB_Plus_601" #Ignore
		ai_chance = { factor = 100 }
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = -1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_ignored_succession_law
				who = ROOT
				months = 120
			}
		}
	}
}

# Vassals vote to approve or disapprove Primogeniture
letter_event = {
	id = Plus.602 #formerly 1000182998
	desc = "EVTDESC_Plus_602"

	is_triggered_only = yes

	option = {
		name = "EVTOPTA_Plus_601" #Approve
		ai_chance = {
			factor = 75
			modifier = {
				factor = 10.0
				FROM = {
					reverse_opinion = { who = ROOT value = 99 }
				}
			}
			modifier = {
				factor = 5.0
				FROM = {
					reverse_opinion = { who = ROOT value = 75 }
				}
			}
			modifier = {
				factor = 2.0
				FROM = {
					reverse_opinion = { who = ROOT value = 50 }
				}
			}
			modifier = {
				factor = 0.5
				NOT = {
					FROM = {
						reverse_opinion = { who = ROOT value = 25 }
					}
				}
			}
			modifier = {
				factor = 0.01
				NOT = {
					FROM = {
						reverse_opinion = { who = ROOT value = 0 }
					}
				}
			}
			modifier = {
				factor = 0.01
				event_target:changed_title = {
					current_heir = {
						character = ROOT
						NOT = { is_child_of = FROM }
					}
				}
			}
			modifier = {
				factor = 0.5
				OR = {
					leads_faction = faction_tradition
					in_faction = faction_tradition
				}
			}
			modifier = {
				factor = 0.1
				is_child_of = FROM
				OR = {
					AND = {
						event_target:changed_title = {
							OR = {
								has_law = agnatic_succession
								has_law = cognatic_succession
							}
						}
						any_sibling = {
							NOT = { trait = bastard }
							is_female = no
							is_older_than = ROOT
						}
					}
					AND = {
						event_target:changed_title = {
							OR = {
								has_law = enatic_succession
								has_law = enatic_cognatic_succession
							}
						}
						any_sibling = {
							NOT = { trait = bastard }
							is_female = yes
							is_older_than = ROOT
						}
					}
					AND = {
						event_target:changed_title = { has_law = true_cognatic_succession }
						any_sibling = {
							NOT = { trait = bastard }
							is_older_than = ROOT
						}
					}
				}
			}
			modifier = {
				factor = 0.5
				NOT = { same_realm = FROM }
			}
			modifier = {
				factor = 0.25
				event_target:changed_title = { has_law = succ_feudal_elective }
				NOT = { dynasty = FROM }
			}
			modifier = {
				factor = 0.5
				NOT = { event_target:changed_title = { has_law = succ_feudal_elective } }
				NOT = { dynasty = FROM }
			}
			modifier = {
				factor = 5.0
				event_target:changed_title = { has_law = succ_feudal_elective }
				NOT = { is_child_of = FROM }
				OR = {
					is_married = FROM
					father = { is_child_of = FROM }
				}
			}
			modifier = {
				factor = 10.0
				is_child_of = FROM
				NOR = {
					AND = {
						event_target:changed_title = {
							OR = {
								has_law = agnatic_succession
								has_law = cognatic_succession
							}
						}
						any_sibling = {
							NOT = { trait = bastard }
							is_female = no
							is_older_than = ROOT
						}
					}
					AND = {
						event_target:changed_title = {
							OR = {
								has_law = enatic_succession
								has_law = enatic_cognatic_succession
							}
						}
						any_sibling = {
							NOT = { trait = bastard }
							is_female = yes
							is_older_than = ROOT
						}
					}
					AND = {
						event_target:changed_title = { has_law = true_cognatic_succession }
						any_sibling = {
							NOT = { trait = bastard }
							is_older_than = ROOT
						}
					}
				}
			}
			modifier = {
				factor = 0.5
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_0
							has_law = tribal_organization_0
						}
					}
				}
			}
			modifier = {
				factor = 0.75
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_1
							has_law = tribal_organization_1
						}
					}
				}
			}
			modifier = {
				factor = 1.5
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_3
							has_law = tribal_organization_3
						}
					}
				}
			}
			modifier = {
				factor = 2.0
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_4
							has_law = tribal_organization_4
						}
					}
				}
			}
		}
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = 1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_approved_succession_law
				who = ROOT
				months = 120
			}
		}
	}

	option = {
		name = "EVTOPTB_Plus_601" #Ignore
		ai_chance = { factor = 100 }
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = -1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_ignored_succession_law
				who = ROOT
				months = 120
			}
		}
	}
}

# Vassals vote to approve or disapprove Seniority
letter_event = {
	id = Plus.603 #formerly 1000182999
	desc = "EVTDESC_Plus_603"

	is_triggered_only = yes

	option = {
		name = "EVTOPTA_Plus_601" #Approve
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10.0
				FROM = {
					reverse_opinion = { who = ROOT value = 99 }
				}
			}
			modifier = {
				factor = 5.0
				FROM = {
					reverse_opinion = { who = ROOT value = 75 }
				}
			}
			modifier = {
				factor = 2.0
				FROM = {
					reverse_opinion = { who = ROOT value = 50 }
				}
			}
			modifier = {
				factor = 0.5
				NOT = {
					FROM = {
						reverse_opinion = { who = ROOT value = 25 }
					}
				}
			}
			modifier = {
				factor = 0.01
				NOT = {
					FROM = {
						reverse_opinion = { who = ROOT value = 0 }
					}
				}
			}
			modifier = {
				factor = 0.01
				event_target:changed_title = {
					current_heir = {
						character = ROOT
						NOT = { dynasty = FROM }
					}
				}
			}
			modifier = {
				factor = 0.5
				OR = {
					leads_faction = faction_tradition
					in_faction = faction_tradition
				}
			}
			modifier = {
				factor = 0.5
				NOT = { same_realm = FROM }
			}
			modifier = {
				factor = 0.25
				event_target:changed_title = { has_law = succ_feudal_elective }
				NOT = { dynasty = FROM }
			}
			modifier = {
				factor = 2.0
				OR = {
					culture_group = east_slavic
					culture_group = west_slavic
					culture_group = south_slavic
					culture = hungarian
				}
			}
			modifier = {
				factor = 10.0
				dynasty = FROM
			}
			modifier = {
				factor = 0.5
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_0
							has_law = tribal_organization_0
						}
					}
				}
			}
			modifier = {
				factor = 0.75
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_1
							has_law = tribal_organization_1
						}
					}
				}
			}
			modifier = {
				factor = 1.5
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_3
							has_law = tribal_organization_3
						}
					}
				}
			}
			modifier = {
				factor = 2.0
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_4
							has_law = tribal_organization_4
						}
					}
				}
			}
		}
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = 1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_approved_succession_law
				who = ROOT
				months = 120
			}
		}
	}

	option = {
		name = "EVTOPTB_Plus_601" #Ignore
		ai_chance = { factor = 100 }
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = -1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_ignored_succession_law
				who = ROOT
				months = 120
			}
		}
	}
}

# Vassals vote to approve or disapprove Tanistry
letter_event = {
	id = Plus.615
	desc = "EVTDESC_Plus_615"

	is_triggered_only = yes

	option = {
		name = "EVTOPTA_Plus_601" #Approve
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10.0
				FROM = {
					reverse_opinion = { who = ROOT value = 99 }
				}
			}
			modifier = {
				factor = 5.0
				FROM = {
					reverse_opinion = { who = ROOT value = 75 }
				}
			}
			modifier = {
				factor = 2.0
				FROM = {
					reverse_opinion = { who = ROOT value = 50 }
				}
			}
			modifier = {
				factor = 0.5
				NOT = {
					FROM = {
						reverse_opinion = { who = ROOT value = 25 }
					}
				}
			}
			modifier = {
				factor = 0.01
				NOT = {
					FROM = {
						reverse_opinion = { who = ROOT value = 0 }
					}
				}
			}
			modifier = {
				factor = 0.01
				event_target:changed_title = {
					current_heir = {
						character = ROOT
						NOT = { dynasty = FROM }
					}
				}
			}
			modifier = {
				factor = 0.5
				OR = {
					leads_faction = faction_tradition
					in_faction = faction_tradition
				}
			}
			modifier = {
				factor = 0.5
				NOT = { same_realm = FROM }
			}
			modifier = {
				factor = 0.25
				event_target:changed_title = { has_law = succ_feudal_elective }
				NOT = { dynasty = FROM }
			}
			modifier = {
				factor = 2.0
				OR = {
					culture_group = celtic
					culture = scottish
					religion = celtic_pagan
				}
			}
			modifier = {
				factor = 10.0
				dynasty = FROM
			}
			modifier = {
				factor = 0.5
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_0
							has_law = tribal_organization_0
						}
					}
				}
			}
			modifier = {
				factor = 0.75
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_1
							has_law = tribal_organization_1
						}
					}
				}
			}
			modifier = {
				factor = 1.5
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_3
							has_law = tribal_organization_3
						}
					}
				}
			}
			modifier = {
				factor = 2.0
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_4
							has_law = tribal_organization_4
						}
					}
				}
			}
		}
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = 1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_approved_succession_law
				who = ROOT
				months = 120
			}
		}
	}

	option = {
		name = "EVTOPTB_Plus_601" #Ignore
		ai_chance = { factor = 100 }
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = -1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_ignored_succession_law
				who = ROOT
				months = 120
			}
		}
	}
}

# Vassals vote to approve or disapprove Feudal Elective
letter_event = {
	id = Plus.616
	desc = "EVTDESC_Plus_616"

	is_triggered_only = yes

	option = {
		name = "EVTOPTA_Plus_601" #Approve
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10.0
				FROM = {
					reverse_opinion = { who = ROOT value = 99 }
				}
			}
			modifier = {
				factor = 5.0
				FROM = {
					reverse_opinion = { who = ROOT value = 75 }
				}
			}
			modifier = {
				factor = 2.0
				FROM = {
					reverse_opinion = { who = ROOT value = 50 }
				}
			}
			modifier = {
				factor = 0.75
				NOT = {
					FROM = {
						reverse_opinion = { who = ROOT value = 25 }
					}
				}
			}
			modifier = {
				factor = 0.5
				NOT = {
					FROM = {
						reverse_opinion = { who = ROOT value = 0 }
					}
				}
			}
			modifier = {
				factor = 0.01
				event_target:changed_title = {
					NOT = { has_law = succ_elective_gavelkind }
					current_heir = { character = ROOT }
				}
			}
			modifier = {
				factor = 0.5
				OR = {
					leads_faction = faction_tradition
					in_faction = faction_tradition
				}
			}
			modifier = {
				factor = 0.5
				NOT = { same_realm = FROM }
			}
			modifier = {
				factor = 0.5
				dynasty = FROM
			}
			modifier = {
				factor = 2.5
				NOT = { dynasty = FROM }
			}
			modifier = {
				factor = 2.0
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_0
							has_law = tribal_organization_0
						}
					}
				}
			}
			modifier = {
				factor = 1.5
				event_target:changed_title = {
					crownlaw_title = {
						OR = {
							has_law = crown_authority_1
							has_law = tribal_organization_1
						}
					}
				}
			}
		}
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = 1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_approved_succession_law
				who = ROOT
				months = 120
			}
		}
	}

	option = {
		name = "EVTOPTB_Plus_601" #Ignore
		ai_chance = { factor = 100 }
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = -1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_ignored_succession_law
				who = ROOT
				months = 120
			}
		}
	}
}

# The law passes or is defeated
character_event = {
	id = Plus.610
	desc = "EVTDESC_Plus_610"
	picture = GFX_evt_council

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				check_variable = { which = "succession_law_vote" value = -0.5 }
				has_character_flag = vote_is_for_gavelkind
			}
			clr_character_flag = vote_is_for_gavelkind
			event_target:changed_title = {
				#set flag so we know what the former law was
				if = {
					limit = { is_primary_holder_title = yes }
					clr_title_flag = former_gavelkind
					clr_title_flag = former_seniority
					clr_title_flag = former_primogeniture
					clr_title_flag = former_feudal_elective
					clr_title_flag = former_tanistry
					clr_title_flag = former_ultimogeniture
					if = {
						limit = { has_law = succ_gavelkind }
						set_title_flag = former_gavelkind
					}
					if = {
						limit = { has_law = succ_seniority }
						set_title_flag = former_seniority
					}
					if = {
						limit = { has_law = succ_primogeniture }
						set_title_flag = former_primogeniture
					}
					if = {
						limit = { has_law = succ_feudal_elective }
						set_title_flag = former_feudal_elective
					}
					if = {
						limit = { has_law = succ_tanistry }
						set_title_flag = former_tanistry
					}
					if = {
						limit = { has_law = succ_ultimogeniture }
						set_title_flag = former_ultimogeniture
					}
				}
				
				#set opinion changes for heirs and pretenders
				current_heir = { set_character_flag = former_heir }
				ROOT = {
					any_realm_character = {
						limit = {
							any_pretender_title = { title = event_target:changed_title }
						}
						set_character_flag = former_pretender
					}
					any_independent_ruler = {
						any_realm_character = {
							limit = {
								any_pretender_title = { title = event_target:changed_title }
							}
							set_character_flag = former_pretender
						}
					}
					character_event = { id = Plus.604 days = 5 }
				}
				
				#actually change the law
				add_law = succ_gavelkind
				
				#current heir is unhappy (they have to share) if they were the previous heir
				current_heir = {
					if = { 
						limit = { has_character_flag = former_heir }
						opinion = {
							who = ROOT
							modifier = opinion_succ_law_change
							months = 240
						}
					}
				}
				
				ROOT = {
					#legitimate children are happy
					any_child = {
						limit = {
							NOR = {
								trait = bastard
								trait = monk
								trait = nun
								trait = disinherited
								has_character_flag = former_heir
								has_character_flag = former_pretender
								any_heir_title = { title = event_target:changed_title }
								any_pretender_title = { title = event_target:changed_title }
								has_opinion_modifier = { who = ROOT modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = ROOT
							modifier = opinion_good_succ_law_change
							months = 240
						}
					}
					#vassals are slightly upset
					any_vassal = {
						limit = {
							OR = {
								primary_title = { de_jure_liege_or_above = event_target:changed_title }
								event_target:changed_title = { is_primary_holder_title = yes }
								event_target:changed_title = { is_titular = yes }
							}
							NOR = {
								has_opinion_modifier = { who = ROOT modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = ROOT
							modifier = opinion_succ_law_change
							months = 240
						}
					}
				}
				
				any_de_jure_vassal_title = {
					limit = {
						holder_scope = { has_character_flag = vote_is_for_gavelkind }
					}
					holder_scope = {
						if = {
							limit = { has_character_flag = voted_on_gavelkind }
							character_event = { id = Plus.611 }
						}
						clr_character_flag = succession_vote
						clr_character_flag = voted_on_gavelkind
						clr_character_flag = vote_is_for_gavelkind
					}
				}
			}
			break = yes
		}
		if = {
			limit = {
				check_variable = { which = "succession_law_vote" value = -0.5 }
				has_character_flag = vote_is_for_primogeniture
			}			
			clr_character_flag = vote_is_for_primogeniture
			event_target:changed_title = {
				#set flag so we know what the former law was
				if = {
					limit = { is_primary_holder_title = yes }
					clr_title_flag = former_gavelkind
					clr_title_flag = former_seniority
					clr_title_flag = former_primogeniture
					clr_title_flag = former_feudal_elective
					clr_title_flag = former_tanistry
					clr_title_flag = former_ultimogeniture
					if = {
						limit = { has_law = succ_gavelkind }
						set_title_flag = former_gavelkind
					}
					if = {
						limit = { has_law = succ_seniority }
						set_title_flag = former_seniority
					}
					if = {
						limit = { has_law = succ_primogeniture }
						set_title_flag = former_primogeniture
					}
					if = {
						limit = { has_law = succ_feudal_elective }
						set_title_flag = former_feudal_elective
					}
					if = {
						limit = { has_law = succ_tanistry }
						set_title_flag = former_tanistry
					}
					if = {
						limit = { has_law = succ_ultimogeniture }
						set_title_flag = former_ultimogeniture
					}
				}
				
				#set opinion changes for heirs and pretenders
				current_heir = { set_character_flag = former_heir }
				ROOT = {
					any_realm_character = {
						limit = {
							any_pretender_title = { title = event_target:changed_title }
						}
						set_character_flag = former_pretender
					}
					any_independent_ruler = {
						any_realm_character = {
							limit = {
								any_pretender_title = { title = event_target:changed_title }
							}
							set_character_flag = former_pretender
						}
					}
					character_event = { id = Plus.604 days = 5 }
				}
				
				#actually change the law
				add_law = succ_primogeniture
				
				#current heir is pleased
				current_heir = {
					opinion = {
						who = ROOT
						modifier = opinion_good_succ_law_change
						months = 240
					}
				}
				
				ROOT = {
					#legitimate children are upset
					any_child = {
						limit = {
							NOR = {
								trait = bastard
								trait = monk
								trait = nun
								trait = disinherited
								has_character_flag = former_heir
								has_character_flag = former_pretender
								any_heir_title = { title = event_target:changed_title }
								any_pretender_title = { title = event_target:changed_title }
								has_opinion_modifier = { who = ROOT modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = ROOT
							modifier = opinion_bad_succ_law_change
							months = 240
						}
					}
					#vassals are slightly upset
					any_vassal = {
						limit = {
							OR = {
								primary_title = { de_jure_liege_or_above = event_target:changed_title }
								event_target:changed_title = { is_primary_holder_title = yes }
								event_target:changed_title = { is_titular = yes }
							}
							NOR = {
								has_opinion_modifier = { who = ROOT modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = ROOT
							modifier = opinion_succ_law_change
							months = 240
						}
					}
				}
				
				any_de_jure_vassal = {
					limit = { has_character_flag = voted_on_primogeniture }
					character_event = { id = Plus.611 }
					clr_character_flag = succession_vote
					clr_character_flag = voted_on_primogeniture
				}
			}
			break = yes
		}
		if = {
			limit = {
				check_variable = { which = "succession_law_vote" value = -0.5 }
				has_character_flag = vote_is_for_seniority
			}			
			clr_character_flag = vote_is_for_seniority
			event_target:changed_title = {
				#set flag so we know what the former law was
				if = {
					limit = { is_primary_holder_title = yes }
					clr_title_flag = former_gavelkind
					clr_title_flag = former_seniority
					clr_title_flag = former_primogeniture
					clr_title_flag = former_feudal_elective
					clr_title_flag = former_tanistry
					clr_title_flag = former_ultimogeniture
					if = {
						limit = { has_law = succ_gavelkind }
						set_title_flag = former_gavelkind
					}
					if = {
						limit = { has_law = succ_seniority }
						set_title_flag = former_seniority
					}
					if = {
						limit = { has_law = succ_primogeniture }
						set_title_flag = former_primogeniture
					}
					if = {
						limit = { has_law = succ_feudal_elective }
						set_title_flag = former_feudal_elective
					}
					if = {
						limit = { has_law = succ_tanistry }
						set_title_flag = former_tanistry
					}
					if = {
						limit = { has_law = succ_ultimogeniture }
						set_title_flag = former_ultimogeniture
					}
				}
				
				#set opinion changes for heirs and pretenders
				current_heir = { set_character_flag = former_heir }
				ROOT = {
					any_realm_character = {
						limit = {
							any_pretender_title = { title = event_target:changed_title }
						}
						set_character_flag = former_pretender
					}
					any_independent_ruler = {
						any_realm_character = {
							limit = {
								any_pretender_title = { title = event_target:changed_title }
							}
							set_character_flag = former_pretender
						}
					}
					character_event = { id = Plus.604 days = 5 }
				}

				#actually change the law
				add_law = succ_seniority
				
				ROOT = {
					#legitimate children are angry
					any_child = {
						limit = {
							NOR = {
								trait = bastard
								trait = monk
								trait = nun
								trait = disinherited
								any_heir_title = { title = event_target:changed_title }
								any_pretender_title = { title = event_target:changed_title }
								has_opinion_modifier = { who = ROOT modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = ROOT
							modifier = opinion_bad_succ_law_change
							months = 240
						}
					}
					#dynasty members are pleased
					any_dynasty_member = {
						limit = {
							NOR = {
								has_opinion_modifier = { who = ROOT modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = ROOT
							modifier = opinion_good_succ_law_change
							months = 240
						}
					}
					#vassals are slightly upset
					any_vassal = {
						limit = {
							OR = {
								primary_title = { de_jure_liege_or_above = event_target:changed_title }
								event_target:changed_title = { is_primary_holder_title = yes }
								event_target:changed_title = { is_titular = yes }
							}
							NOR = {
								has_opinion_modifier = { who = ROOT modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = ROOT
							modifier = opinion_succ_law_change
							months = 240
						}
					}
				}
				
				any_de_jure_vassal = {
					limit = { has_character_flag = voted_on_seniority }
					character_event = { id = Plus.611 }
					clr_character_flag = succession_vote
					clr_character_flag = voted_on_seniority
				}
			}
			break = yes
		}
		if = {
			limit = {
				check_variable = { which = "succession_law_vote" value = -0.5 }
				has_character_flag = vote_is_for_tanistry
			}			
			clr_character_flag = vote_is_for_tanistry
			event_target:changed_title = {
				#set flag so we know what the former law was
				if = {
					limit = { is_primary_holder_title = yes }
					clr_title_flag = former_gavelkind
					clr_title_flag = former_seniority
					clr_title_flag = former_primogeniture
					clr_title_flag = former_feudal_elective
					clr_title_flag = former_tanistry
					clr_title_flag = former_ultimogeniture
					if = {
						limit = { has_law = succ_gavelkind }
						set_title_flag = former_gavelkind
					}
					if = {
						limit = { has_law = succ_seniority }
						set_title_flag = former_seniority
					}
					if = {
						limit = { has_law = succ_primogeniture }
						set_title_flag = former_primogeniture
					}
					if = {
						limit = { has_law = succ_feudal_elective }
						set_title_flag = former_feudal_elective
					}
					if = {
						limit = { has_law = succ_tanistry }
						set_title_flag = former_tanistry
					}
					if = {
						limit = { has_law = succ_ultimogeniture }
						set_title_flag = former_ultimogeniture
					}
				}
				
				#set opinion changes for heirs and pretenders
				current_heir = { set_character_flag = former_heir }
				ROOT = {
					any_realm_character = {
						limit = {
							any_pretender_title = { title = event_target:changed_title }
						}
						set_character_flag = former_pretender
					}
					any_independent_ruler = {
						any_realm_character = {
							limit = {
								any_pretender_title = { title = event_target:changed_title }
							}
							set_character_flag = former_pretender
						}
					}
					character_event = { id = Plus.604 days = 5 }
				}

				#actually change the law
				add_law = succ_tanistry

				any_de_jure_vassal = {
					limit = {
						OR = {
							AND = {
								tier = baron
								PREV = { tier = count }
							}
							AND = {
								tier = count
								PREV = { tier = duke }
							}
							higher_tier_than = count
						}
					}
					set_character_flag = dejure_vassal
				}
				ROOT = {
					#all legitimate children are upset
					any_child = {
						limit = {
							NOR = {
								trait = bastard
								trait = monk
								trait = nun
								trait = disinherited
								has_opinion_modifier = { who = PREV modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = PREV
							modifier = opinion_bad_succ_law_change
							months = 240
						}
					}
					#dynasty members are somewhat upset
					any_dynasty_member = {
						limit = {
							NOR = {
								has_opinion_modifier = { who = PREV modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = PREV
							modifier = opinion_succ_law_change
							months = 240
						}
					}
					#electors are pleased
					any_vassal = {
						limit = {
							has_character_flag = dejure_vassal
							NOR = {
								has_opinion_modifier = { who = PREV modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = PREV
							modifier = opinion_good_succ_law_change
							months = 240
						}
					}
					#other vassals are slightly upset
					any_vassal = {
						limit = {
							OR = {
								primary_title = { de_jure_liege_or_above = event_target:changed_title }
								event_target:changed_title = { is_primary_holder_title = yes }
								event_target:changed_title = { is_titular = yes }
							}
							NOR = {
								has_opinion_modifier = { who = PREV modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = PREV
							modifier = opinion_succ_law_change
							months = 240
						}
					}
				}
				any_de_jure_vassal = {
					clr_character_flag = dejure_vassal
				}
				
				any_de_jure_vassal = {
					limit = { has_character_flag = voted_on_tanistry }
					character_event = { id = Plus.611 }
					clr_character_flag = succession_vote
					clr_character_flag = voted_on_tanistry
				}
			}
			break = yes
		}
		if = {
			limit = {
				check_variable = { which = "succession_law_vote" value = -0.5 }
				has_character_flag = vote_is_for_feudal_elective
			}			
			clr_character_flag = vote_is_for_feudal_elective
			event_target:changed_title = {
				#set flag so we know what the former law was
				if = {
					limit = { is_primary_holder_title = yes }
					clr_title_flag = former_gavelkind
					clr_title_flag = former_seniority
					clr_title_flag = former_primogeniture
					clr_title_flag = former_feudal_elective
					clr_title_flag = former_tanistry
					clr_title_flag = former_ultimogeniture
					if = {
						limit = { has_law = succ_gavelkind }
						set_title_flag = former_gavelkind
					}
					if = {
						limit = { has_law = succ_seniority }
						set_title_flag = former_seniority
					}
					if = {
						limit = { has_law = succ_primogeniture }
						set_title_flag = former_primogeniture
					}
					if = {
						limit = { has_law = succ_feudal_elective }
						set_title_flag = former_feudal_elective
					}
					if = {
						limit = { has_law = succ_tanistry }
						set_title_flag = former_tanistry
					}
					if = {
						limit = { has_law = succ_ultimogeniture }
						set_title_flag = former_ultimogeniture
					}
				}
				
				#set opinion changes for heirs and pretenders
				current_heir = { set_character_flag = former_heir }
				ROOT = {
					any_realm_character = {
						limit = {
							any_pretender_title = { title = event_target:changed_title }
						}
						set_character_flag = former_pretender
					}
					any_independent_ruler = {
						any_realm_character = {
							limit = {
								any_pretender_title = { title = event_target:changed_title }
							}
							set_character_flag = former_pretender
						}
					}
					character_event = { id = Plus.604 days = 5 }
				}

				#actually change the law
				add_law = succ_feudal_elective

				any_de_jure_vassal = {
					limit = {
						OR = {
							AND = {
								tier = baron
								PREV = { tier = count }
							}
							AND = {
								tier = count
								PREV = { tier = duke }
							}
							higher_tier_than = count
						}
					}
					set_character_flag = dejure_vassal
				}
				ROOT = {
					#all legitimate children are upset
					any_child = {
						limit = {
							NOR = {
								trait = bastard
								trait = monk
								trait = nun
								trait = disinherited
								has_opinion_modifier = { who = PREV modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = PREV
							modifier = opinion_bad_succ_law_change
							months = 240
						}
					}
					#dynasty members are somewhat upset
					any_dynasty_member = {
						limit = {
							NOR = {
								has_opinion_modifier = { who = PREV modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = PREV
							modifier = opinion_succ_law_change
							months = 240
						}
					}
					#electors are pleased
					any_vassal = {
						limit = {
							has_character_flag = dejure_vassal
							NOR = {
								has_opinion_modifier = { who = PREV modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = PREV
							modifier = opinion_good_succ_law_change
							months = 240
						}
					}
					#other vassals are slightly upset
					any_vassal = {
						limit = {
							OR = {
								primary_title = { de_jure_liege_or_above = event_target:changed_title }
								event_target:changed_title = { is_primary_holder_title = yes }
								event_target:changed_title = { is_titular = yes }
							}
							NOR = {
								has_opinion_modifier = { who = PREV modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = PREV modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = PREV
							modifier = opinion_succ_law_change
							months = 240
						}
					}
				}
				any_de_jure_vassal = {
					clr_character_flag = dejure_vassal
				}

				any_de_jure_vassal = {
					limit = { has_character_flag = voted_on_feudal_elective }
					character_event = { id = Plus.611 }
					clr_character_flag = succession_vote
					clr_character_flag = voted_on_feudal_elective
				}
			}
			break = yes
		}
		if = {
			limit = { has_character_flag = vote_is_for_gavelkind }
			clr_character_flag = vote_is_for_gavelkind
			event_target:changed_title = {
				any_de_jure_vassal = {
					limit = { has_character_flag = voted_on_gavelkind }
					character_event = { id = Plus.612 }
					clr_character_flag = succession_vote
					clr_character_flag = voted_on_gavelkind
				}
			}
			break = yes
		}
		if = {
			limit = { has_character_flag = vote_is_for_primogeniture }
			clr_character_flag = vote_is_for_primogeniture
			event_target:changed_title = {
				any_de_jure_vassal = {
					limit = { has_character_flag = voted_on_primogeniture }
					character_event = { id = Plus.612 }
					clr_character_flag = succession_vote
					clr_character_flag = voted_on_primogeniture
				}
			}
			break = yes
		}
		if = {
			limit = { has_character_flag = vote_is_for_seniority }
			clr_character_flag = vote_is_for_seniority
			event_target:changed_title = {
				any_de_jure_vassal = {
					limit = { has_character_flag = voted_on_seniority }
					character_event = { id = Plus.612 }
					clr_character_flag = succession_vote
					clr_character_flag = voted_on_seniority
				}
			}
			break = yes
		}
		if = {
			limit = { has_character_flag = vote_is_for_tanistry }
			clr_character_flag = vote_is_for_tanistry
			event_target:changed_title = {
				any_de_jure_vassal = {
					limit = { has_character_flag = voted_on_tanistry }
					character_event = { id = Plus.612 }
					clr_character_flag = succession_vote
					clr_character_flag = voted_on_tanistry
				}
			}
			break = yes
		}
		if = {
			limit = { has_character_flag = vote_is_for_feudal_elective }
			clr_character_flag = vote_is_for_feudal_elective
			event_target:changed_title = {
				any_de_jure_vassal = {
					limit = { has_character_flag = voted_on_feudal_elective }
					character_event = { id = Plus.612 }
					clr_character_flag = succession_vote
					clr_character_flag = voted_on_feudal_elective
				}
			}
			break = yes
		}
	}

	option = {
		name = "EVTOPTA_Plus_610" #Approved
		trigger = {
			check_variable = { which = "succession_law_vote" value = -0.5 }
		}
		hidden_tooltip = {
			set_variable = { which = "succession_law_vote" value = 0 }
		}
		ROOT = {
			custom_tooltip = { text = CUSTOMTOOLTIP8 }
		}
		event_target:changed_title = {
			any_de_jure_vassal = {
				limit = {
					reverse_has_opinion_modifier = {
						who = ROOT
						modifier = opinion_approved_succession_law
					}
				}
				custom_tooltip = { text = CUSTOMTOOLTIP8 }
			}
		}
		event_target:changed_title = {
			any_de_jure_vassal = {
				limit = {
					reverse_has_opinion_modifier = {
						who = ROOT
						modifier = opinion_ignored_succession_law
					}
				}
				custom_tooltip = { text = CUSTOMTOOLTIP9 }
			}
		}
		clr_character_flag = voting_on_succession_law
	}

	option = {
		name = "EVTOPTB_Plus_610" #Rejected
		trigger = {
			NOT = { check_variable = { which = "succession_law_vote" value = -0.5 } }
		}
		hidden_tooltip = {
			set_variable = { which = "succession_law_vote" value = 0 }
		}
		ROOT = {
			custom_tooltip = { text = CUSTOMTOOLTIP8 }
		}
		event_target:changed_title = {
			any_de_jure_vassal = {
				limit = {
					reverse_has_opinion_modifier = {
						who = ROOT
						modifier = opinion_approved_succession_law
					}
				}
				custom_tooltip = { text = CUSTOMTOOLTIP8 }
			}
		}
		event_target:changed_title = {
			any_de_jure_vassal = {
				limit = {
					reverse_has_opinion_modifier = {
						who = ROOT
						modifier = opinion_ignored_succession_law
					}
				}
				custom_tooltip = { text = CUSTOMTOOLTIP9 }
			}
		}
		if = {
			limit = { event_target:changed_title = { tier = BARON } }
			prestige = 65
		}
		if = {
			limit = { event_target:changed_title = { tier = COUNT } }
			prestige = 125
		}
		if = {
			limit = { event_target:changed_title = { tier = DUKE } }
			prestige = 250
		}
		if = {
			limit = { event_target:changed_title = { tier = KING } }
			prestige = 375
		}
		if = {
			limit = { event_target:changed_title = { tier = EMPEROR } }
			prestige = 50
		}
		clr_character_flag = voting_on_succession_law
	}
}

# Notification - success
character_event = {
	id = Plus.611
	desc = "EVTDESC_Plus_611"
	picture = GFX_evt_council

	is_triggered_only = yes

	trigger = {
		ai = no
	}

	option = {
		name = "OK"
		FROM = {
			custom_tooltip = { text = CUSTOMTOOLTIP8 }
		}
		event_target:changed_title = {
			any_de_jure_vassal = {
				limit = {
					reverse_has_opinion_modifier = {
						who = FROM
						modifier = opinion_approved_succession_law
					}
				}
				custom_tooltip = { text = CUSTOMTOOLTIP8 }
			}
		}
		event_target:changed_title = {
			any_de_jure_vassal = {
				limit = {
					reverse_has_opinion_modifier = {
						who = FROM
						modifier = opinion_ignored_succession_law
					}
				}
				custom_tooltip = { text = CUSTOMTOOLTIP9 }
			}
		}
	}
}

# Notification - failure
character_event = {
	id = Plus.612
	desc = "EVTDESC_Plus_612"
	picture = GFX_evt_council

	is_triggered_only = yes

	trigger = {
		ai = no
	}

	option = {
		name = "OK"
		FROM = {
			custom_tooltip = { text = CUSTOMTOOLTIP8 }
		}
		event_target:changed_title = {
			any_de_jure_vassal = {
				limit = {
					reverse_has_opinion_modifier = {
						who = FROM
						modifier = opinion_approved_succession_law
					}
				}
				custom_tooltip = { text = CUSTOMTOOLTIP8 }
			}
		}
		event_target:changed_title = {
			any_de_jure_vassal = {
				limit = {
					reverse_has_opinion_modifier = {
						who = FROM
						modifier = opinion_ignored_succession_law
					}
				}
				custom_tooltip = { text = CUSTOMTOOLTIP9 }
			}
		}
	}
}

#######################################
# REACTIONS TO SUCCESSION LAW CHANGES
# Written by Rylock
#######################################

# Base event fired on the ruler after changing a law
character_event = {
	id = Plus.604
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_demesne_title = {
			limit = { has_title_flag = title_to_change }
			clr_title_flag = title_to_change
			save_event_target_as = changed_title
		}
		# former heir is now neither heir nor pretender
		any_realm_character = {
			limit = {
				has_character_flag = former_heir
				NOT = { any_heir_title = { title = event_target:changed_title } }
				NOT = { any_pretender_title = { title = event_target:changed_title } }
			}
			remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
			character_event = { id = Plus.605 }
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					has_character_flag = former_heir
					NOT = { any_heir_title = { title = event_target:changed_title } }
					NOT = { any_pretender_title = { title = event_target:changed_title } }
				}
				remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
				character_event = { id = Plus.605 }
			}
		}
		
		# former heir is now pretender
		any_realm_character = {
			limit = {
				has_character_flag = former_heir
				NOT = { any_heir_title = { title = event_target:changed_title } }
				NOT = { has_character_flag = former_pretender }
				any_pretender_title = { title = event_target:changed_title }
			}
			remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
			character_event = { id = Plus.606 }
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					has_character_flag = former_heir
					NOT = { any_heir_title = { title = event_target:changed_title } }
					NOT = { has_character_flag = former_pretender }
					any_pretender_title = { title = event_target:changed_title }
				}
				remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
				character_event = { id = Plus.606 }
			}
		}
		
		# former pretender is now neither heir nor pretender
		any_realm_character = {
			limit = {
				has_character_flag = former_pretender
				NOT = { any_heir_title = { title = event_target:changed_title } }
				NOT = { any_pretender_title = { title = event_target:changed_title } }
			}
			remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
			character_event = { id = Plus.607 }
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					has_character_flag = former_pretender
					NOT = { any_heir_title = { title = event_target:changed_title } }
					NOT = { any_pretender_title = { title = event_target:changed_title } }
				}
				remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
				character_event = { id = Plus.607 }
			}
		}
		
		# the new heir
		event_target:changed_title = {
			current_heir = {
				if = {
					limit = {
						NOT = { has_character_flag = former_heir }
					}
					remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
					remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
					remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
					character_event = { id = Plus.608 }
				}
			}
		}
		
		# the new pretenders
		any_realm_character = {
			limit = {
				NOT = { has_character_flag = former_heir }
				NOT = { has_character_flag = former_pretender }
				NOT = { any_heir_title = { title = event_target:changed_title } }
				any_pretender_title = { title = event_target:changed_title }
			}
			remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
			character_event = { id = Plus.609 }
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					NOT = { has_character_flag = former_heir }
					NOT = { has_character_flag = former_pretender }
					NOT = { any_heir_title = { title = event_target:changed_title } }
					any_pretender_title = { title = event_target:changed_title }
				}
				remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
				character_event = { id = Plus.609 }
			}
		}
		
		#clear the flags
		any_realm_character = {
			clr_character_flag = former_heir
			clr_character_flag = former_pretender
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				clr_character_flag = former_heir
				clr_character_flag = former_pretender
			}
		}
	}
}

# A former heir is now neither the heir nor a pretender
character_event = {
	id = Plus.605
	picture = "GFX_evt_scandal"
	desc = "EVTDESC_Plus_605"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_Plus_605" #So be it
		trigger = {
			NOR = {
				trait = lunatic
				trait = possessed
			}
		}
		ai_chance = {
			factor = 30
			modifier = {
				factor = 3
				trait = content
			}
			modifier = {
				factor = 2
				trait = humble
			}
			modifier = {
				factor = 1.5
				trait = charitable
			}
			modifier = {
				factor = 1.5
				trait = patient
			}
			modifier = {
				factor = 1.5
				trait = trusting
			}
			modifier = {
				factor = 0.5
				trait = proud
			}
			modifier = {
				factor = 0.25
				trait = ambitious
			}
		}
		FROM = {
			reverse_opinion = {
				who = ROOT
				modifier = opinion_bad_succ_law_change
				months = 240
			}
		}
		event_target:changed_title = {
			current_heir = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					multiplier = 2
					months = 120
				}
			}
		}
		any_realm_character = {
			limit = {
				any_pretender_title = { title = event_target:changed_title }
			}
			reverse_opinion = {
				who = ROOT
				modifier = opinion_resentful
				months = 120
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					any_pretender_title = { title = event_target:changed_title }
				}
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					months = 120
				}
			}
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
				NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			FROM = {
				reverse_opinion = {
					who = PREV
					modifier = opinion_bad_succ_law_change
					months = 240
				}
			}
			event_target:changed_title = {
				current_heir = {
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						multiplier = 2
						months = 120
					}
				}
			}
			any_realm_character = {
				limit = {
					any_pretender_title = { title = event_target:changed_title }
				}
				reverse_opinion = {
					who = PREV
					modifier = opinion_resentful
					months = 120
				}
			}
			any_independent_ruler = {
				limit = { NOT = { same_realm = ROOT } }
				any_realm_character = {
					limit = {
						any_pretender_title = { title = event_target:changed_title }
					}
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						months = 120
					}
				}
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
					NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				FROM = {
					reverse_opinion = {
						who = PREV
						modifier = opinion_bad_succ_law_change
						months = 240
					}
				}
				event_target:changed_title = {
					current_heir = {
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							multiplier = 2
							months = 120
						}
					}
				}
				any_realm_character = {
					limit = {
						any_pretender_title = { title = event_target:changed_title }
					}
					reverse_opinion = {
						who = PREV
						modifier = opinion_resentful
						months = 120
					}
				}
				any_independent_ruler = {
					limit = { NOT = { same_realm = ROOT } }
					any_realm_character = {
						limit = {
							any_pretender_title = { title = event_target:changed_title }
						}
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							months = 120
						}
					}
				}
			}
		}
	}
	option = {
		name = "EVTOPTB_Plus_605" #This is an outrage!
		ai_chance = {
			factor = 70
			modifier = {
				factor = 3
				trait = ambitious
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = envious
			}
			modifier = {
				factor = 1.5
				trait = greedy
			}
			modifier = {
				factor = 1.5
				trait = wroth
			}
			modifier = {
				factor = 1.5
				trait = paranoid
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 0.25
				trait = content
			}
		}
		FROM = {
			reverse_opinion = {
				who = ROOT
				modifier = succ_law_disinherit
				months = 240
			}
		}
		event_target:changed_title = {
			current_heir = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					multiplier = 5
					months = 240
				}
			}
		}
		any_realm_character = {
			limit = {
				any_pretender_title = { title = event_target:changed_title }
			}
			reverse_opinion = {
				who = ROOT
				modifier = opinion_resentful
				multiplier = 2
				months = 240
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					any_pretender_title = { title = event_target:changed_title }
				}
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					multiplier = 2
					months = 240
				}
			}
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
				NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			FROM = {
				reverse_opinion = {
					who = PREV
					modifier = opinion_bad_succ_law_change
					multiplier = 2
					months = 240
				}
			}
			event_target:changed_title = {
				current_heir = {
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						multiplier = 5
						months = 240
					}
				}
			}
			any_realm_character = {
				limit = {
					any_pretender_title = { title = event_target:changed_title }
				}
				reverse_opinion = {
					who = PREV
					modifier = opinion_resentful
					multiplier = 2
					months = 240
				}
			}
			any_independent_ruler = {
				limit = { NOT = { same_realm = ROOT } }
				any_realm_character = {
					limit = {
						any_pretender_title = { title = event_target:changed_title }
					}
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						multiplier = 2
						months = 240
					}
				}
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
					NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				FROM = {
					reverse_opinion = {
						who = PREV
						modifier = opinion_bad_succ_law_change
						multiplier = 2
						months = 240
					}
				}
				event_target:changed_title = {
					current_heir = {
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							multiplier = 5
							months = 240
						}
					}
				}
				any_realm_character = {
					limit = {
						any_pretender_title = { title = event_target:changed_title }
					}
					reverse_opinion = {
						who = PREV
						modifier = opinion_resentful
						multiplier = 2
						months = 240
					}
				}
				any_independent_ruler = {
					limit = { NOT = { same_realm = ROOT } }
					any_realm_character = {
						limit = {
							any_pretender_title = { title = event_target:changed_title }
						}
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							multiplier = 2
							months = 240
						}
					}
				}
			}
		}
	}
}

# A former heir is now pretender
character_event = {
	id = Plus.606
	picture = "GFX_evt_scandal"
	desc = "EVTDESC_Plus_606"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_Plus_605" #So be it
		trigger = {
			NOR = {
				trait = lunatic
				trait = possessed
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 3
				trait = content
			}
			modifier = {
				factor = 2
				trait = humble
			}
			modifier = {
				factor = 1.5
				trait = charitable
			}
			modifier = {
				factor = 1.5
				trait = patient
			}
			modifier = {
				factor = 1.5
				trait = trusting
			}
			modifier = {
				factor = 0.5
				trait = proud
			}
			modifier = {
				factor = 0.25
				trait = ambitious
			}
		}
		FROM = {
			reverse_opinion = {
				who = ROOT
				modifier = opinion_bad_succ_law_change
				months = 240
			}
		}
		event_target:changed_title = {
			current_heir = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					multiplier = 2
					months = 120
				}
			}
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
				NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			FROM = {
				reverse_opinion = {
					who = PREV
					modifier = opinion_bad_succ_law_change
					months = 240
				}
			}
			event_target:changed_title = {
				current_heir = {
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						multiplier = 2
						months = 120
					}
				}
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
					NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				FROM = {
					reverse_opinion = {
						who = PREV
						modifier = opinion_bad_succ_law_change
						months = 240
					}
				}
				event_target:changed_title = {
					current_heir = {
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							multiplier = 2
							months = 120
						}
					}
				}
			}
		}
	}
	option = {
		name = "EVTOPTB_Plus_605" #This is an outrage!
		ai_chance = {
			factor = 50
			modifier = {
				factor = 3
				trait = ambitious
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = envious
			}
			modifier = {
				factor = 1.5
				trait = greedy
			}
			modifier = {
				factor = 1.5
				trait = wroth
			}
			modifier = {
				factor = 1.5
				trait = paranoid
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 0.25
				trait = content
			}
		}
		FROM = {
			reverse_opinion = {
				who = ROOT
				modifier = opinion_bad_succ_law_change
				multiplier = 2
				months = 240
			}
		}
		event_target:changed_title = {
			current_heir = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					multiplier = 5
					months = 240
				}
			}
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
				NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			FROM = {
				reverse_opinion = {
					who = PREV
					modifier = opinion_bad_succ_law_change
					multiplier = 2
					months = 240
				}
			}
			event_target:changed_title = {
				current_heir = {
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						multiplier = 5
						months = 240
					}
				}
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
					NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				FROM = {
					reverse_opinion = {
						who = PREV
						modifier = opinion_bad_succ_law_change
						multiplier = 2
						months = 240
					}
				}
				event_target:changed_title = {
					current_heir = {
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							multiplier = 5
							months = 240
						}
					}
				}
			}
		}
	}
}

# A former pretender is now neither the heir nor a pretender
character_event = {
	id = Plus.607
	picture = "GFX_evt_scandal"
	desc = "EVTDESC_Plus_607"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_Plus_605" #So be it
		trigger = {
			NOR = {
				trait = lunatic
				trait = possessed
			}
		}
		ai_chance = {
			factor = 70
			modifier = {
				factor = 3
				trait = content
			}
			modifier = {
				factor = 2
				trait = humble
			}
			modifier = {
				factor = 1.5
				trait = charitable
			}
			modifier = {
				factor = 1.5
				trait = patient
			}
			modifier = {
				factor = 1.5
				trait = trusting
			}
			modifier = {
				factor = 0.5
				trait = proud
			}
			modifier = {
				factor = 0.25
				trait = ambitious
			}
		}
		FROM = {
			reverse_opinion = {
				who = ROOT
				modifier = opinion_bad_succ_law_change
				months = 240
			}
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
				NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			opinion = {
				who = FROM
				modifier = opinion_bad_succ_law_change
				months = 240
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
					NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				opinion = {
					who = FROM
					modifier = opinion_bad_succ_law_change
					months = 240
				}
			}
		}
	}
	option = {
		name = "EVTOPTB_Plus_605" #This is an outrage!
		ai_chance = {
			factor = 30
			modifier = {
				factor = 3
				trait = ambitious
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = envious
			}
			modifier = {
				factor = 1.5
				trait = greedy
			}
			modifier = {
				factor = 1.5
				trait = wroth
			}
			modifier = {
				factor = 1.5
				trait = paranoid
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 0.25
				trait = content
			}
		}
		FROM = {
			reverse_opinion = {
				who = ROOT
				modifier = opinion_bad_succ_law_change
				multiplier = 2
				months = 240
			}
		}
		event_target:changed_title = {
			current_heir = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					multiplier = 2
					months = 240
				}
			}
		}
		any_realm_character = {
			limit = {
				any_pretender_title = { title = event_target:changed_title }
			}
			reverse_opinion = {
				who = ROOT
				modifier = opinion_resentful
				months = 240
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					any_pretender_title = { title = event_target:changed_title }
				}
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					months = 240
				}
			}
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
				NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			FROM = {
				reverse_opinion = {
					who = PREV
					modifier = opinion_bad_succ_law_change
					multiplier = 2
					months = 240
				}
			}
			event_target:changed_title = {
				current_heir = {
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						multiplier = 2
						months = 240
					}
				}
			}
			any_realm_character = {
				limit = {
					any_pretender_title = { title = event_target:changed_title }
				}
				reverse_opinion = {
					who = PREV
					modifier = opinion_resentful
					months = 240
				}
			}
			any_independent_ruler = {
				limit = { NOT = { same_realm = ROOT } }
				any_realm_character = {
					limit = {
						any_pretender_title = { title = event_target:changed_title }
					}
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						months = 240
					}
				}
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
					NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				FROM = {
					reverse_opinion = {
						who = PREV
						modifier = opinion_bad_succ_law_change
						multiplier = 2
						months = 240
					}
				}
				event_target:changed_title = {
					current_heir = {
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							multiplier = 2
							months = 240
						}
					}
				}
				any_realm_character = {
					limit = {
						any_pretender_title = { title = event_target:changed_title }
					}
					reverse_opinion = {
						who = PREV
						modifier = opinion_resentful
						months = 240
					}
				}
				any_independent_ruler = {
					limit = { NOT = { same_realm = ROOT } }
					any_realm_character = {
						limit = {
							any_pretender_title = { title = event_target:changed_title }
						}
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							months = 240
						}
					}
				}
			}
		}
	}
}

# The new heir is informed
character_event = {
	id = Plus.608
	picture = "GFX_evt_emissary"
	desc = "EVTDESC_Plus_608"
	
	is_triggered_only = yes
	
	option = {
		name = "EXCELLENT"
		opinion = {
			who = FROM
			modifier = opinion_good_succ_law_change
			multiplier = 2
			months = 240
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			opinion = {
				who = FROM
				modifier = opinion_good_succ_law_change
				months = 240
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				opinion = {
					who = FROM
					modifier = opinion_good_succ_law_change
					months = 240
				}
			}
		}
	}
}

# The new pretenders are informed
character_event = {
	id = Plus.609
	picture = "GFX_evt_emissary"
	desc = "EVTDESC_Plus_609"
	
	is_triggered_only = yes
	
	option = {
		name = "EXCELLENT"
		opinion = {
			who = FROM
			modifier = opinion_good_succ_law_change
			months = 240
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			opinion = {
				who = FROM
				modifier = opinion_good_succ_law_change
				months = 240
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				opinion = {
					who = FROM
					modifier = opinion_good_succ_law_change
					months = 240
				}
			}
		}
	}
}

######################################
# ASKING VASSALS TO SUPPORT YOUR HEIR
# Written by Rylock
######################################

# Vassal is asked to support the current heir
character_event = {
	id = Plus.1600
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		FROMFROM = { current_heir = { save_event_target_as = liege_heir } }
		log = "[Root.GetTitledName] has been asked by [FromFrom.GetTitledName] to support [FromFrom.GetHerHis] heir, [liege.heir.GetTitledName]."
		opinion = { who = FROMFROM modifier = asked_to_support_heir years = 20 }
		random_list = {
			50 = {
				modifier = {
					factor = 1.5
					FROMFROM = { primary_title = { has_law = crown_authority_4 } }
				}
				modifier = {
					factor = 1.5
					is_friend = FROMFROM
				}
				modifier = {
					factor = 1.2
					opinion = { who = FROMFROM value = 90 }
				}
				modifier = {
					factor = 1.2
					FROMFROM = { diplomacy = 16 }
				}
				modifier = {
					factor = 1.2
					FROMFROM = { diplomacy = 20 }
				}
				modifier = {
					factor = 1.5
					is_friend = event_target:liege_heir
				}
				modifier = {
					factor = 1.5
					is_close_relative = event_target:liege_heir
				}
				modifier = {
					factor = 1.2
					event_target:liege_heir = { is_ruler = yes }
				}
				modifier = {
					factor = 1.1
					opinion = { who = event_target:liege_heir value = 20 }
				}
				modifier = {
					factor = 1.1
					opinion = { who = event_target:liege_heir value = 40 }
				}
				modifier = {
					factor = 1.1
					opinion = { who = event_target:liege_heir value = 60 }
				}
				modifier = {
					factor = 1.1
					opinion = { who = event_target:liege_heir value = 80 }
				}
				modifier = {
					factor = 1.2
					trait = trusting
				}
				modifier = {
					factor = 1.5
					trait = content
				}
				modifier = {
					factor = 1.2
					trait = humble
				}
				modifier = {
					factor = 1.2
					trait = kind
				}
				FROMFROM = { letter_event = { id = Plus.1601 days = 15 } } # Agree
			}
			50 = {
				modifier = {
					factor = 0.5
					FROMFROM = { primary_title = { has_law = crown_authority_4 } }
				}
				modifier = {
					factor = 1.2
					FROMFROM = { NOT = { diplomacy = 8 } }
				}
				modifier = {
					factor = 1.2
					FROMFROM = { NOT = { diplomacy = 4 } }
				}
				modifier = {
					factor = 1.2
					NOT = { opinion = { who = FROMFROM value = 70 } }
				}
				modifier = {
					factor = 1.2
					NOT = { opinion = { who = event_target:liege_heir value = 0 } }
				}
				modifier = {
					factor = 1.5
					NOT = { opinion = { who = event_target:liege_heir value = -25 } }
				}
				modifier = {
					factor = 1.5
					NOT = { opinion = { who = event_target:liege_heir value = -50 } }
				}
				modifier = {
					factor = 1.5
					event_target:liege_heir = { is_female = yes }
					FROMFROM = {
						primary_title = {
							OR = {
								has_law = agnatic_succession
								has_law = cognatic_succession
							}
						}
					}
				}
				modifier = {
					factor = 1.5
					event_target:liege_heir = { is_female = no }
					FROMFROM = {
						primary_title = {
							OR = {
								has_law = enatic_succession
								has_law = enatic_cognatic_succession
							}
						}
					}
				}
				modifier = {
					factor = 1.5
					event_target:liege_heir = {
						OR = {
							trait = imbecile
							trait = lunatic
							trait = possessed
							trait = incapable
						}
					}
				}
				modifier = {
					factor = 1.5
					NOR = {
						religion = event_target:liege_heir
						culture = event_target:liege_heir
					}
				}
				modifier = {
					factor = 1.2
					trait = paranoid
				}
				modifier = {
					factor = 1.5
					trait = ambitious
				}
				modifier = {
					factor = 1.2
					trait = proud
				}
				modifier = {
					factor = 1.2
					trait = envious
				}
				modifier = {
					factor = 1.2
					trait = cruel
				}
				FROMFROM = { letter_event = { id = Plus.1602 days = 15 } } # Refuse
			}
		}
	}
}

# Vassal agrees to support heir
letter_event = {
	id = Plus.1601
	desc = EVTDESC_Plus_1601
	border = GFX_event_letter_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		current_heir = { character = event_target:liege_heir }
		FROM = { vassal_of = ROOT }
	}
	
	option = {
		name = EXCELLENT
		FROM = {
			opinion = { who = event_target:liege_heir modifier = sworn_to_support_heir years = 20 }
			reverse_opinion = { who = ROOT modifier = opinion_pleased years = 5 }
		}
	}
}

# Vassal refuses to support heir
letter_event = {
	id = Plus.1602
	desc = EVTDESC_Plus_1602
	border = GFX_event_letter_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		current_heir = { character = event_target:liege_heir }
		FROM = { vassal_of = ROOT }
	}
	
	option = {
		name = CURSES
		opinion = { who = FROM modifier = refused_to_support_heir years = 10 }
		if = {
			limit = { FROM = { tier = COUNT } }
			prestige = 50
		}
		if = {
			limit = { FROM = { tier = DUKE } }
			prestige = 125
		}
		if = {
			limit = { FROM = { tier = KING } }
			prestige = 250
		}
	}
}

# Maintenance event: remove support for heir if he is neither heir nor liege
character_event = {
	id = Plus.1603
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		any_opinion_modifier_target = {
			reverse_has_opinion_modifier = {
				who = ROOT
				modifier = sworn_to_support_heir
			}
			NOR = {
				is_liege_or_above = ROOT
				any_heir_title = {
					is_primary_holder_title = yes
					holder_scope = { is_vassal_or_below = ROOT }
				}
			}
		}
	}
	
	weight_multiplier = {
		days = 1
	}
	
	immediate = {
		any_opinion_modifier_target = {
			limit = {
				reverse_has_opinion_modifier = {
					who = ROOT
					modifier = sworn_to_support_heir
				}
				NOR = {
					is_liege_or_above = ROOT
					any_heir_title = {
						is_primary_holder_title = yes
						holder_scope = { is_vassal_or_below = ROOT }
					}
				}
			}
			reverse_remove_opinion = {
				who = ROOT
				modifier = sworn_to_support_heir
			}
		}
	}
}

######################################
# SUCCESSION CRISIS EVENTS
# Written by Rylock
######################################

# King/Emperor dies at low CA with possibly unsuitable heir
character_event = {
	id = Plus.1610
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		is_feudal = yes
		primary_title = {
			higher_tier_than = DUKE
			temporary = no
			#low crown authority
			OR = {
				has_law = crown_authority_0
				has_law = crown_authority_1
			}
			#only applies to certain succession laws
			OR = {
				has_law = succ_seniority
				has_law = succ_primogeniture
				has_law = succ_ultimogeniture
				has_law = succ_feudal_elective
				has_law = succ_tanistry
			}
			#current heir is female or unsuitable
			OR = {
				AND = {
					OR = {
						has_law = cognatic_succession
						has_law = true_cognatic_succession
					}
					current_heir = { is_female = yes }
					ROOT = { 
						is_female = no 
						not_is_feminist_trigger = yes
					}
				}
				current_heir = {
					OR = {
						NOT = { age = 13 }
						trait = incapable
						trait = imbecile
						trait = inbred
						trait = lunatic
					}
				}
			}
		}
		#at least three vassals who can vote
		any_vassal = {
			has_regent = no
			higher_real_tier_than = COUNT
			count = 3
		}
		#there is another suitable male heir available
		any_dynasty_member = {
			is_alive = yes
			OR = {
				is_female = no
				ROOT = {
					is_feminist_trigger = yes
				}
			}
			is_theocracy = no
			is_republic = no
			mercenary = no
			holy_order = no
			age = 13
			NOR = {
				is_primary_heir = ROOT
				character = ROOT
				trait = incapable
				trait = imbecile
				trait = inbred
				trait = lunatic
				trait = possessed
				trait = eunuch
				trait = monk
				trait = nun
				trait = abdicated
				trait = disinherited
				trait = druid
				trait = bad_druid
				trait = retired_vestalis
				trait = vestalis
				any_liege = {
					OR = {
						holy_order = yes
						mercenary = yes
					}
				}
			}
		}
	}
	
	immediate = {
		set_variable = { which = "succ_candidates" value = 0 }
		current_heir = { save_event_target_as = next_in_line }
		
		#check whether we should be accepting female candidates
		if = {
			limit = {
				is_female = no
				not_is_feminist_trigger = yes
				current_heir = {
					is_female = yes
					age = 13
					NOR = {
						trait = incapable
						trait = imbecile
						trait = inbred
						trait = lunatic
					}
				}
			}
			set_character_flag = no_female_candidates
		}
		
		#find candidates for non-voting succession laws
		if = {
			limit = {
				primary_title = {
					OR = {
						has_law = succ_seniority
						has_law = succ_primogeniture
						has_law = succ_ultimogeniture
					}
				}
			}
			#save current laws
			primary_title = {
				if = {
					limit = { has_law = succ_seniority }
					set_title_flag = revert_seniority
				}
				if = {
					limit = { has_law = succ_primogeniture }
					set_title_flag = revert_primogeniture
				}
				if = {
					limit = { has_law = succ_ultimogeniture }
					set_title_flag = revert_ultimogeniture
				}
				if = {
					limit = { has_law = cognatic_succession }
					set_title_flag = revert_cognatic
				}
				if = {
					limit = { has_law = true_cognatic_succession }
					set_title_flag = revert_true_cognatic
				}
				if = {
					limit = { has_law = agnatic_succession }
					set_title_flag = revert_agnatic
				}
				if = {
					limit = { has_law = enatic_succession }
					set_title_flag = revert_enatic
				}
				if = {
					limit = { has_law = enatic_cognatic_succession }
					set_title_flag = revert_enatic_cognatic
				}
			}
			
			#first the actual pretender
			current_heir = { 
				add_trait = disinherited 
				ROOT = {
					recalc_succession = yes
					current_heir = { 
						if = {
							limit = {
								OR = {
									is_female = no
									ROOT = { NOT = { has_character_flag = no_female_candidates } }
								}
								age = 13
								NOR = {
									character = event_target:next_in_line
									trait = incapable
									trait = imbecile
									trait = inbred
									trait = lunatic
								}
							}
							save_event_target_as = candidate_second_heir
							ROOT = { change_variable = { which = "succ_candidates" value = 1 } }
						}
					}
				}
				remove_trait = disinherited 
			}
			recalc_succession = yes
			
			#then the male candidate
			if = {
				limit = {
					current_heir = { is_female = yes }
				}
				primary_title = { gender_succ = agnatic }
				recalc_succession = yes
				current_heir = { 
					if = {
						limit = {
							age = 13
							NOR = {
								character = event_target:next_in_line
								character = event_target:candidate_second_heir
								trait = incapable
								trait = imbecile
								trait = inbred
								trait = lunatic
							}
						}
						save_event_target_as = candidate_male
						ROOT = { change_variable = { which = "succ_candidates" value = 1 } }
					}	
				}
			}
			
			#then an older female candidate
			if = {
				limit = {
					current_heir = { is_female = no }
					ROOT = { NOT = { has_character_flag = no_female_candidates } }
				}
				primary_title = { gender_succ = true_cognatic }
				recalc_succession = yes
				current_heir = { 
					if = {
						limit = {
							age = 13
							NOR = {
								character = event_target:next_in_line
								character = event_target:candidate_second_heir
								character = event_target:candidate_male
								trait = incapable
								trait = imbecile
								trait = inbred
								trait = lunatic
							}
						}
						save_event_target_as = candidate_female
						ROOT = { change_variable = { which = "succ_candidates" value = 1 } }
					}	
				}
			}
			
			#restore gender law
			primary_title = {
				if = {
					limit = { has_title_flag = revert_agnatic }
					clr_title_flag = revert_agnatic
					gender_succ = agnatic
				}
				if = {
					limit = { has_title_flag = revert_cognatic }
					clr_title_flag = revert_cognatic
					gender_succ = cognatic
				}
				if = {
					limit = { has_title_flag = revert_true_cognatic }
					clr_title_flag = revert_true_cognatic
					gender_succ = true_cognatic
				}
				if = {
					limit = { has_title_flag = revert_enatic }
					clr_title_flag = revert_enatic
					gender_succ = enatic
				}
				if = {
					limit = { has_title_flag = revert_enatic_cognatic }
					clr_title_flag = revert_enatic_cognatic
					gender_succ = enatic_cognatic
				}
			}
			
			#then the primogeniture candidate
			if = {
				limit = {
					primary_title = { NOT = { has_title_flag = revert_primogeniture } }
					NOT = { check_variable = { which = "succ_candidates" value = 2.5 } }
				}
				primary_title = { succession = primogeniture }
				recalc_succession = yes
				current_heir = { 
					if = {
						limit = {
							OR = {
								is_female = no
								ROOT = { NOT = { has_character_flag = no_female_candidates } }
							}
							age = 13
							NOR = {
								character = event_target:next_in_line
								character = event_target:candidate_second_heir
								character = event_target:candidate_male
								character = event_target:candidate_female
								trait = incapable
								trait = imbecile
								trait = inbred
								trait = lunatic
							}
						}
						save_event_target_as = candidate_primo
						ROOT = { change_variable = { which = "succ_candidates" value = 1 } }
					}	
				}
			}
			
			#then the seniority candidate
			if = {
				limit = {
					primary_title = { NOT = { has_title_flag = revert_seniority } }
					NOT = { check_variable = { which = "succ_candidates" value = 2.5 } }
				}
				primary_title = { succession = seniority }
				recalc_succession = yes
				current_heir = { 
					if = {
						limit = {
							OR = {
								is_female = no
								ROOT = { NOT = { has_character_flag = no_female_candidates } }
							}
							age = 13
							NOR = {
								character = event_target:next_in_line
								character = event_target:candidate_second_heir
								character = event_target:candidate_male
								character = event_target:candidate_female
								character = event_target:candidate_primo
								trait = incapable
								trait = imbecile
								trait = inbred
								trait = lunatic
							}
						}
						save_event_target_as = candidate_senior
						ROOT = { change_variable = { which = "succ_candidates" value = 1 } }
					}
				}
			}
			
			#restore succession law
			primary_title = {
				if = {
					limit = { has_title_flag = revert_primogeniture }
					clr_title_flag = revert_primogeniture
					succession = primogeniture
				}
				if = {
					limit = { has_title_flag = revert_seniority }
					clr_title_flag = revert_seniority
					succession = seniority
				}
				if = {
					limit = { has_title_flag = revert_ultimogeniture }
					clr_title_flag = revert_ultimogeniture
					succession = ultimogeniture
				}
			}
			recalc_succession = yes
			clear_event_target = next_in_line
		}
		
		#find candidates for voting succession laws
		if = {
			limit = {
				primary_title = {
					OR = {
						has_law = succ_feudal_elective
						has_law = succ_tanistry
					}
				}
			}
			#first find the actual pretenders
			top_liege = {
				random_realm_character = {
					limit = {
						any_pretender_title = {
							is_primary_holder_title = yes
							holder_scope = { character = ROOT }
						}
						OR = {
							is_female = no
							ROOT = { NOT = { has_character_flag = no_female_candidates } }
						}
						age = 13
						NOR = {
							character = event_target:next_in_line
							trait = incapable
							trait = imbecile
							trait = inbred
							trait = lunatic
						}
					}
					save_event_target_as = candidate_second_heir
					ROOT = { change_variable = { which = "succ_candidates" value = 1 } }
				}
				random_realm_character = {
					limit = {
						any_pretender_title = {
							is_primary_holder_title = yes
							holder_scope = { character = ROOT }
						}
						OR = {
							is_female = no
							ROOT = { NOT = { has_character_flag = no_female_candidates } }
						}
						age = 13
						NOT = {
							character = event_target:next_in_line
							character = event_target:candidate_second_heir
							trait = incapable
							trait = imbecile
							trait = inbred
							trait = lunatic
						}
					}
					save_event_target_as = candidate_primo
					ROOT = { change_variable = { which = "succ_candidates" value = 1 } }
				}
			}
			#then pick the eldest valid child
			random_child = {
				limit = {
					is_alive = yes
					OR = {
						dynasty = ROOT
						calc_true_if = {
							amount = 2
							diplomacy = 15
							diplomacy = 21
							martial = 15
							stewardship = 15
							trait = genius
							higher_tier_than = COUNT
						}
					}
					OR = {
						is_female = no
						ROOT = { NOT = { has_character_flag = no_female_candidates } }
					}
					age = 13
					NOR = {
						character = event_target:next_in_line
						character = event_target:candidate_second_heir
						character = event_target:candidate_male
						trait = incapable
						trait = imbecile
						trait = inbred
						trait = lunatic
						trait = eunuch
						trait = monk
						trait = nun
						trait = abdicated
						trait = disinherited
						trait = druid
						trait = bad_druid
						trait = retired_vestalis
						trait = vestalis
						any_liege = {
							OR = {
								holy_order = yes
								mercenary = yes
							}
						}
						any_sibling = {
							is_older_than = PREV
							OR = {
								dynasty = ROOT
								calc_true_if = {
									amount = 2
									diplomacy = 15
									diplomacy = 21
									martial = 15
									stewardship = 15
									trait = genius
									higher_tier_than = COUNT
								}
							}
							OR = {
								is_female = no
								ROOT = { NOT = { has_character_flag = no_female_candidates } }
							}
							NOR = {
								trait = incapable
								trait = imbecile
								trait = inbred
								trait = lunatic
								trait = eunuch
								trait = monk
								trait = nun
								trait = abdicated
								trait = disinherited
								trait = druid
								trait = bad_druid
								trait = retired_vestalis
								trait = vestalis
								any_liege = {
									OR = {
										holy_order = yes
										mercenary = yes
									}
								}
							}
						}
					}
				}
				save_event_target_as = candidate_primo
				ROOT = { change_variable = { which = "succ_candidates" value = 1 } }
			}
		}
		
		#then the ability candidate, if there is one
		if = {
			limit = {
				NOT = { check_variable = { which = "succ_candidates" value = 2.5 } }
			}
			random_dynasty_member = {
				limit = {
					OR = {
						is_female = no
						ROOT = { NOT = { has_character_flag = no_female_candidates } }
					}
					is_alive = yes
					is_theocracy = no
					is_republic = no
					mercenary = no
					holy_order = no
					is_adult = yes
					same_realm = ROOT
					calc_true_if = {
						amount = 2
						diplomacy = 15
						diplomacy = 21
						martial = 15
						stewardship = 15
						trait = genius
						higher_tier_than = COUNT
						any_pretender_title = {
							holder_scope = { character = ROOT }
							is_primary_holder_title = yes
						}
					}
					NOR = {
						character = event_target:next_in_line
						character = event_target:candidate_second_heir
						character = event_target:candidate_male
						character = event_target:candidate_female
						character = event_target:candidate_primo
						character = event_target:candidate_senior
						is_primary_heir = ROOT
						character = ROOT
						trait = incapable
						trait = imbecile
						trait = inbred
						trait = lunatic
						trait = possessed
						trait = eunuch
						trait = monk
						trait = nun
						trait = abdicated
						trait = disinherited
						trait = druid
						trait = bad_druid
						trait = retired_vestalis
						trait = vestalis
						any_liege = {
							OR = {
								holy_order = yes
								mercenary = yes
							}
						}
					}
				}
				save_event_target_as = candidate_ability
				ROOT = { change_variable = { which = "succ_candidates" value = 1 } }
			}
		}
		
		#is there still a succession crisis?
		if = {
			limit = { check_variable = { which = "succ_candidates" value = 0.5 } }
			current_heir = {
				if = {
					limit = { NOT = { age = 13 } }
					set_character_flag = crisis_too_young
				}
				if = {
					limit = {
						age = 13
						OR = {
							trait = incapable
							trait = imbecile
							trait = inbred
							trait = lunatic
						}
					}
					set_character_flag = crisis_unsuitable
				}
				if = {
					limit = {
						age = 13
						NOR = {
							trait = incapable
							trait = imbecile
							trait = inbred
							trait = lunatic
						}
					}
					set_character_flag = crisis_female
				}				
				ROOT = {
					any_demesne_title = {
						limit = { current_heir = { character = PREVPREVPREV } }
						set_title_flag = will_be_inherited
					}
				}
				narrative_event = { id = Plus.1611 days = 1 }
				character_event = { id = Plus.1617 days = 1 }
			}
		}
	}
}

# The succession crisis is raised
narrative_event = {
	id = Plus.1611
	title = EVTNAME_Plus_1611
	picture = GFX_evt_coronation
	
	desc = {
		text = EVTDESC_Plus_1611A
		trigger = { has_character_flag = crisis_too_young }
	}
	desc = {
		text = EVTDESC_Plus_1611B
		trigger = { has_character_flag = crisis_unsuitable }
	}
	desc = {
		text = EVTDESC_Plus_1611C
		trigger = { has_character_flag = crisis_female }
	}
	
	is_triggered_only = yes
	
	trigger = {
		NOR = {
			trait = rebel
			any_demesne_title = { is_contested = yes }
			any_demesne_title = { temporary = yes }
			has_character_flag = faction_court_war
			has_character_flag = faction_prosperity_war
			has_character_flag = faction_glory_war
			has_character_flag = faction_tradition_war
			has_character_flag = faction_separatist_war
			has_character_flag = faction_pretender_war
			has_character_flag = faction_religious_war
		}
	}
	
	immediate = {
		log = "The [Root.PrimaryTitle.GetFullName] has a succession crisis!"
		add_character_modifier = {
			name = succession_crisis
			duration = 8
		}
		set_variable = { which = "votes_for_heir" value = 0 }
		set_variable = { which = "votes_against_heir" value = 0 }
		set_variable = { which = "votes_for_second_heir" value = 0 }
		set_variable = { which = "votes_for_male" value = 0 }
		set_variable = { which = "votes_for_female" value = 0 }
		set_variable = { which = "votes_for_primo" value = 0 }
		set_variable = { which = "votes_for_senior" value = 0 }
		set_variable = { which = "votes_for_ability" value = 0 }
	}

	option = {
		name = EVTOPTA_Plus_1611
		event_target:candidate_second_heir = { custom_tooltip = { text = IS_SUCCESSION_CANDIDATE } }
		event_target:candidate_male = { custom_tooltip = { text = IS_SUCCESSION_CANDIDATE } }
		event_target:candidate_female = { custom_tooltip = { text = IS_SUCCESSION_CANDIDATE } }
		event_target:candidate_primo = { custom_tooltip = { text = IS_SUCCESSION_CANDIDATE } }
		event_target:candidate_senior = { custom_tooltip = { text = IS_SUCCESSION_CANDIDATE } }
		event_target:candidate_ability = { custom_tooltip = { text = IS_SUCCESSION_CANDIDATE } }
		hidden_tooltip = {
			if = {
				limit = { independent = no }
				top_liege = { narrative_event = { id = Plus.1612 days = 3 } }
			}
			top_liege = {
				any_realm_character = {
					limit = { is_playable = yes }
					narrative_event = { id = Plus.1612 days = 3 }
				}
			}
			any_dynasty_member = {
				limit = {
					NOT = { same_realm = ROOT }
					ai = no
				}
				narrative_event = { id = Plus.1612 days = 3 }
			}
			character_event = { id = Plus.1613 days = 7 }
			character_event = { id = Plus.1617 days = 7 }
		}
	}
}

# Vassals vote on whether to depose the ruler
narrative_event = {
	id = Plus.1612
	title = EVTNAME_Plus_1611
	picture = GFX_evt_coronation
	
	desc = {
		text = EVTDESC_Plus_1612A
		trigger = { FROM = { has_character_flag = crisis_too_young } }
	}
	desc = {
		text = EVTDESC_Plus_1612B
		trigger = { FROM = { has_character_flag = crisis_unsuitable } }
	}
	desc = {
		text = EVTDESC_Plus_1612C
		trigger = { FROM = { has_character_flag = crisis_female } }
	}
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_Plus_1612 #Support current ruler
		trigger = {
			vassal_of = FROM
			higher_tier_than = COUNT
			has_regent = no
		}
		ai_chance = {
			factor = 100
			modifier = {
				factor = 2.0
				FROM = { primary_title = { has_law = crown_authority_1 } }
			}
			modifier = {
				factor = 0.5
				FROM = { is_adult = no }
			}
			modifier = {
				factor = 0.75
				is_female = no
				not_is_feminist_trigger = yes
				FROM = {
					is_female = yes
					primary_title = {
						OR = {
							has_law = cognatic_succession
							has_law = true_cognatic_succession
						}
					}
				}
			}
			modifier = {
				factor = 0.5
				is_female = no
				not_is_feminist_trigger = yes
				FROM = {
					is_female = yes
					primary_title = {
						NOR = {
							has_law = cognatic_succession
							has_law = true_cognatic_succession
						}
					}
				}
			}
			modifier = {
				factor = 0.25
				FROM = {
					OR = {
						trait = incapable
						trait = imbecile
						trait = inbred
					}
				}
			}
			modifier = {
				factor = 0.5
				FROM = { trait = lunatic }
			}
			modifier = {
				factor = 0
				OR = {
					character = event_target:candidate_second_heir
					character = event_target:candidate_male
					character = event_target:candidate_female
					character = event_target:candidate_primo
					character = event_target:candidate_senior
					character = event_target:candidate_ability
				}
				NOR = {
					trait = content
					trait = humble
				}
			}		
			modifier = {
				factor = 0.5
				NOT = { dynasty = FROM }
			}
			modifier = {
				factor = 1.5
				is_close_relative = FROM
			}
			modifier = {
				factor = 2.0
				OR = {
					is_child_of = FROM
					is_father = FROM
					is_mother = FROM
				}
			}
			modifier = {
				factor = 0.5
				NOT = { religion = FROM }
			}
			modifier = {
				factor = 0.75
				NOT = { culture = FROM }
			}
			modifier = {
				factor = 0.75
				NOT = { culture_group = FROM }
			}
			modifier = {
				factor = 1.5
				FROM = {
					primary_title = {
						OR = {
							title = e_roman_empire
							title = e_byzantium
						}
					}
					trait = born_in_the_purple
				}
			}
		}
		hidden_tooltip = {
			FROM = { change_variable = { which = "votes_for_heir" value = 1 } }
		}
		FROM = {
			custom_tooltip = { text = ENDORSE_FOR_SUCCESSION }
		}
		opinion = { who = FROM modifier = supported_in_succession years = 5 }
		reverse_opinion = { who = FROM modifier = supported_in_succession years = 5 }
	}
	option = {
		name = EVTOPTB_Plus_1612 #Support second heir
		trigger = {
			event_target:candidate_second_heir = { is_alive = yes }
			vassal_of = FROM
			higher_tier_than = COUNT
			has_regent = no
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				event_target:candidate_second_heir = {
					NOT = { same_realm = FROM }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_second_heir = { is_adult = no }
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_tradition
					in_faction = faction_tradition
				}
			}
			modifier = {
				factor = 0.75
				is_female = no
				not_is_feminist_trigger = yes
				event_target:candidate_second_heir = {
					is_female = yes
					FROM = {
						primary_title = {
							OR = {
								has_law = cognatic_succession
								has_law = true_cognatic_succession
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.5
				is_female = no
				not_is_feminist_trigger = yes
				event_target:candidate_second_heir = {
					is_female = yes
					FROM = {
						primary_title = {
							NOR = {
								has_law = cognatic_succession
								has_law = true_cognatic_succession
							}
						}
					}
				}
			}
			modifier = {
				factor = 0
				OR = {
					character = event_target:candidate_second_heir
					character = event_target:candidate_male
					character = event_target:candidate_female
					character = event_target:candidate_senior
					character = event_target:candidate_ability
				}
				NOR = {
					trait = content
					trait = humble
				}
			}
			modifier = {
				factor = 0.5
				NOT = { dynasty = event_target:candidate_second_heir }
			}
			modifier = {
				factor = 1.5
				is_close_relative = event_target:candidate_second_heir
			}
			modifier = {
				factor = 2.0
				OR = {
					is_child_of = event_target:candidate_second_heir
					is_father = event_target:candidate_second_heir
					is_mother = event_target:candidate_second_heir
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_second_heir = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 20 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_second_heir = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 30 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_second_heir = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 40 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_second_heir = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 50 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_second_heir = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = FROM second = PREV value = 10 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_second_heir = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = FROM second = PREV value = 20 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				NOT = { religion = event_target:candidate_second_heir }
			}
			modifier = {
				factor = 0.75
				NOT = { culture = event_target:candidate_second_heir }
			}
			modifier = {
				factor = 0.75
				NOT = { culture_group = event_target:candidate_second_heir }
			}
			modifier = {
				factor = 1.2
				event_target:candidate_second_heir = {
					attribute_diff = { character = FROM attribute = diplomacy value = 3 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_second_heir = {
					attribute_diff = { character = FROM attribute = diplomacy value = 5 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_second_heir = {
					attribute_diff = { character = FROM attribute = diplomacy value = 7 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_second_heir = {
					attribute_diff = { character = FROM attribute = diplomacy value = 9 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_second_heir attribute = diplomacy value = 1 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_second_heir attribute = diplomacy value = 3 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_second_heir attribute = diplomacy value = 5 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_second_heir attribute = diplomacy value = 7 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_second_heir attribute = diplomacy value = 9 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_second_heir = {
					attribute_diff = { character = FROM attribute = martial value = 5 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_second_heir = {
					attribute_diff = { character = FROM attribute = martial value = 10 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_second_heir attribute = martial value = 5 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_second_heir attribute = martial value = 10 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_second_heir = {
					attribute_diff = { character = FROM attribute = stewardship value = 5 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_second_heir = {
					attribute_diff = { character = FROM attribute = stewardship value = 10 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_second_heir attribute = stewardship value = 5 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_second_heir attribute = stewardship value = 10 }
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_court
					in_faction = faction_court
				}
				event_target:candidate_second_heir = {
					OR = {
						leads_faction = faction_court
						in_faction = faction_court
					}
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_glory
					in_faction = faction_glory
				}
				event_target:candidate_second_heir = {
					OR = {
						leads_faction = faction_glory
						in_faction = faction_glory
					}
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_prosperity
					in_faction = faction_prosperity
				}
				event_target:candidate_second_heir = {
					OR = {
						leads_faction = faction_prosperity
						in_faction = faction_prosperity
					}
				}
			}
			modifier = {
				factor = 1.5
				FROM = {
					primary_title = {
						OR = {
							title = e_roman_empire
							title = e_byzantium
						}
					}
				}
				event_target:candidate_second_heir = {
					trait = born_in_the_purple
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = { which = "votes_for_second_heir" value = 1 }
				change_variable = { which = "votes_against_heir" value = 1 }
			}
		}
		event_target:candidate_second_heir = {
			custom_tooltip = { text = ENDORSE_FOR_SUCCESSION }
		}
		if = {
			limit = { NOT = { character = event_target:candidate_second_heir } }
			opinion = { who = event_target:candidate_second_heir modifier = supported_in_succession years = 5 }
			reverse_opinion = { who = event_target:candidate_second_heir modifier = supported_in_succession multiplier = 2 years = 5 }
		}
	}
	option = {
		name = EVTOPTC_Plus_1612 #Support male candidate
		trigger = {
			event_target:candidate_male = { is_alive = yes }
			vassal_of = FROM
			higher_tier_than = COUNT
			has_regent = no
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				event_target:candidate_male = {
					NOT = { same_realm = FROM }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_male = { is_adult = no }
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_tradition
					in_faction = faction_tradition
				}
			}
			modifier = {
				factor = 0.75
				is_female = no
				not_is_feminist_trigger = yes
				event_target:candidate_male = {
					is_female = yes
					FROM = {
						primary_title = {
							OR = {
								has_law = cognatic_succession
								has_law = true_cognatic_succession
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.5
				is_female = no
				not_is_feminist_trigger = yes
				event_target:candidate_male = {
					is_female = yes
					FROM = {
						primary_title = {
							NOR = {
								has_law = cognatic_succession
								has_law = true_cognatic_succession
							}
						}
					}
				}
			}
			modifier = {
				factor = 0
				OR = {
					character = event_target:candidate_second_heir
					character = event_target:candidate_male
					character = event_target:candidate_female
					character = event_target:candidate_senior
					character = event_target:candidate_ability
				}
				NOR = {
					trait = content
					trait = humble
				}
			}
			modifier = {
				factor = 0.5
				NOT = { dynasty = event_target:candidate_male }
			}
			modifier = {
				factor = 1.5
				is_close_relative = event_target:candidate_male
			}
			modifier = {
				factor = 2.0
				OR = {
					is_child_of = event_target:candidate_male
					is_father = event_target:candidate_male
					is_mother = event_target:candidate_male
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_male = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 20 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_male = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 30 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_male = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 40 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_male = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 50 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_male = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = FROM second = PREV value = 10 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_male = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = FROM second = PREV value = 20 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				NOT = { religion = event_target:candidate_male }
			}
			modifier = {
				factor = 0.75
				NOT = { culture = event_target:candidate_male }
			}
			modifier = {
				factor = 0.75
				NOT = { culture_group = event_target:candidate_male }
			}
			modifier = {
				factor = 1.2
				event_target:candidate_male = {
					attribute_diff = { character = FROM attribute = diplomacy value = 3 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_male = {
					attribute_diff = { character = FROM attribute = diplomacy value = 5 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_male = {
					attribute_diff = { character = FROM attribute = diplomacy value = 7 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_male = {
					attribute_diff = { character = FROM attribute = diplomacy value = 9 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_male attribute = diplomacy value = 1 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_male attribute = diplomacy value = 3 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_male attribute = diplomacy value = 5 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_male attribute = diplomacy value = 7 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_male attribute = diplomacy value = 9 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_male = {
					attribute_diff = { character = FROM attribute = martial value = 5 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_male = {
					attribute_diff = { character = FROM attribute = martial value = 10 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_male attribute = martial value = 5 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_male attribute = martial value = 10 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_male = {
					attribute_diff = { character = FROM attribute = stewardship value = 5 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_male = {
					attribute_diff = { character = FROM attribute = stewardship value = 10 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_male attribute = stewardship value = 5 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_male attribute = stewardship value = 10 }
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_court
					in_faction = faction_court
				}
				event_target:candidate_male = {
					OR = {
						leads_faction = faction_court
						in_faction = faction_court
					}
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_glory
					in_faction = faction_glory
				}
				event_target:candidate_male = {
					OR = {
						leads_faction = faction_glory
						in_faction = faction_glory
					}
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_prosperity
					in_faction = faction_prosperity
				}
				event_target:candidate_male = {
					OR = {
						leads_faction = faction_prosperity
						in_faction = faction_prosperity
					}
				}
			}
			modifier = {
				factor = 1.5
				FROM = {
					primary_title = {
						OR = {
							title = e_roman_empire
							title = e_byzantium
						}
					}
				}
				event_target:candidate_male = {
					trait = born_in_the_purple
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = { which = "votes_for_male" value = 1 }
				change_variable = { which = "votes_against_heir" value = 1 }
			}
		}
		event_target:candidate_male = {
			custom_tooltip = { text = ENDORSE_FOR_SUCCESSION }
		}
		if = {
			limit = { NOT = { character = event_target:candidate_male } }
			opinion = { who = event_target:candidate_male modifier = supported_in_succession years = 5 }
			reverse_opinion = { who = event_target:candidate_male modifier = supported_in_succession multiplier = 2 years = 5 }
		}
	}
	option = {
		name = EVTOPTD_Plus_1612 #Support female candidate
		trigger = {
			event_target:candidate_female = { is_alive = yes }
			vassal_of = FROM
			higher_tier_than = COUNT
			has_regent = no
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				event_target:candidate_female = {
					NOT = { same_realm = FROM }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_female = { is_adult = no }
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_tradition
					in_faction = faction_tradition
				}
			}
			modifier = {
				factor = 0.75
				is_female = no
				not_is_feminist_trigger = yes
				event_target:candidate_female = {
					is_female = yes
					FROM = {
						primary_title = {
							OR = {
								has_law = cognatic_succession
								has_law = true_cognatic_succession
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.5
				is_female = no
				not_is_feminist_trigger = yes
				event_target:candidate_female = {
					is_female = yes
					FROM = {
						primary_title = {
							NOR = {
								has_law = cognatic_succession
								has_law = true_cognatic_succession
							}
						}
					}
				}
			}
			modifier = {
				factor = 0
				OR = {
					character = event_target:candidate_second_heir
					character = event_target:candidate_male
					character = event_target:candidate_female
					character = event_target:candidate_senior
					character = event_target:candidate_ability
				}
				NOR = {
					trait = content
					trait = humble
				}
			}
			modifier = {
				factor = 0.5
				NOT = { dynasty = event_target:candidate_female }
			}
			modifier = {
				factor = 1.5
				is_close_relative = event_target:candidate_female
			}
			modifier = {
				factor = 2.0
				OR = {
					is_child_of = event_target:candidate_female
					is_father = event_target:candidate_female
					is_mother = event_target:candidate_female
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_female = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 20 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_female = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 30 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_female = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 40 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_female = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 50 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_female = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = FROM second = PREV value = 10 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_female = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = FROM second = PREV value = 20 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				NOT = { religion = event_target:candidate_female }
			}
			modifier = {
				factor = 0.75
				NOT = { culture = event_target:candidate_female }
			}
			modifier = {
				factor = 0.75
				NOT = { culture_group = event_target:candidate_female }
			}
			modifier = {
				factor = 1.2
				event_target:candidate_female = {
					attribute_diff = { character = FROM attribute = diplomacy value = 3 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_female = {
					attribute_diff = { character = FROM attribute = diplomacy value = 5 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_female = {
					attribute_diff = { character = FROM attribute = diplomacy value = 7 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_female = {
					attribute_diff = { character = FROM attribute = diplomacy value = 9 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_female attribute = diplomacy value = 1 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_female attribute = diplomacy value = 3 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_female attribute = diplomacy value = 5 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_female attribute = diplomacy value = 7 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_female attribute = diplomacy value = 9 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_female = {
					attribute_diff = { character = FROM attribute = martial value = 5 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_female = {
					attribute_diff = { character = FROM attribute = martial value = 10 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_female attribute = martial value = 5 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_female attribute = martial value = 10 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_female = {
					attribute_diff = { character = FROM attribute = stewardship value = 5 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_female = {
					attribute_diff = { character = FROM attribute = stewardship value = 10 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_female attribute = stewardship value = 5 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_female attribute = stewardship value = 10 }
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_court
					in_faction = faction_court
				}
				event_target:candidate_female = {
					OR = {
						leads_faction = faction_court
						in_faction = faction_court
					}
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_glory
					in_faction = faction_glory
				}
				event_target:candidate_female = {
					OR = {
						leads_faction = faction_glory
						in_faction = faction_glory
					}
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_prosperity
					in_faction = faction_prosperity
				}
				event_target:candidate_female = {
					OR = {
						leads_faction = faction_prosperity
						in_faction = faction_prosperity
					}
				}
			}
			modifier = {
				factor = 1.5
				FROM = {
					primary_title = {
						OR = {
							title = e_roman_empire
							title = e_byzantium
						}
					}
				}
				event_target:candidate_female = {
					trait = born_in_the_purple
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = { which = "votes_for_female" value = 1 }
				change_variable = { which = "votes_against_heir" value = 1 }
			}
		}
		event_target:candidate_female = {
			custom_tooltip = { text = ENDORSE_FOR_SUCCESSION }
		}
		if = {
			limit = { NOT = { character = event_target:candidate_female } }
			opinion = { who = event_target:candidate_female modifier = supported_in_succession years = 5 }
			reverse_opinion = { who = event_target:candidate_female modifier = supported_in_succession multiplier = 2 years = 5 }
		}
	}
	option = {
		name = EVTOPTE_Plus_1612 #Support primo candidate
		trigger = {
			event_target:candidate_primo = { is_alive = yes }
			vassal_of = FROM
			higher_tier_than = COUNT
			has_regent = no
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				event_target:candidate_primo = {
					NOT = { same_realm = FROM }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_primo = { is_adult = no }
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_tradition
					in_faction = faction_tradition
				}
			}
			modifier = {
				factor = 0.75
				is_female = no
				not_is_feminist_trigger = yes
				event_target:candidate_primo = {
					is_female = yes
					FROM = {
						primary_title = {
							OR = {
								has_law = cognatic_succession
								has_law = true_cognatic_succession
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.5
				is_female = no
				not_is_feminist_trigger = yes
				event_target:candidate_primo = {
					is_female = yes
					FROM = {
						primary_title = {
							NOR = {
								has_law = cognatic_succession
								has_law = true_cognatic_succession
							}
						}
					}
				}
			}
			modifier = {
				factor = 0
				OR = {
					character = event_target:candidate_second_heir
					character = event_target:candidate_male
					character = event_target:candidate_female
					character = event_target:candidate_senior
					character = event_target:candidate_ability
				}
				NOR = {
					trait = content
					trait = humble
				}
			}
			modifier = {
				factor = 0.5
				NOT = { dynasty = event_target:candidate_primo }
			}
			modifier = {
				factor = 1.5
				is_close_relative = event_target:candidate_primo
			}
			modifier = {
				factor = 2.0
				OR = {
					is_child_of = event_target:candidate_primo
					is_father = event_target:candidate_primo
					is_mother = event_target:candidate_primo
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_primo = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 20 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_primo = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 30 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_primo = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 40 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_primo = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 50 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_primo = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = FROM second = PREV value = 10 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_primo = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = FROM second = PREV value = 20 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				NOT = { religion = event_target:candidate_primo }
			}
			modifier = {
				factor = 0.75
				NOT = { culture = event_target:candidate_primo }
			}
			modifier = {
				factor = 0.75
				NOT = { culture_group = event_target:candidate_primo }
			}
			modifier = {
				factor = 1.2
				event_target:candidate_primo = {
					attribute_diff = { character = FROM attribute = diplomacy value = 3 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_primo = {
					attribute_diff = { character = FROM attribute = diplomacy value = 5 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_primo = {
					attribute_diff = { character = FROM attribute = diplomacy value = 7 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_primo = {
					attribute_diff = { character = FROM attribute = diplomacy value = 9 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_primo attribute = diplomacy value = 1 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_primo attribute = diplomacy value = 3 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_primo attribute = diplomacy value = 5 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_primo attribute = diplomacy value = 7 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_primo attribute = diplomacy value = 9 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_primo = {
					attribute_diff = { character = FROM attribute = martial value = 5 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_primo = {
					attribute_diff = { character = FROM attribute = martial value = 10 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_primo attribute = martial value = 5 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_primo attribute = martial value = 10 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_primo = {
					attribute_diff = { character = FROM attribute = stewardship value = 5 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_primo = {
					attribute_diff = { character = FROM attribute = stewardship value = 10 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_primo attribute = stewardship value = 5 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_primo attribute = stewardship value = 10 }
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_court
					in_faction = faction_court
				}
				event_target:candidate_primo = {
					OR = {
						leads_faction = faction_court
						in_faction = faction_court
					}
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_glory
					in_faction = faction_glory
				}
				event_target:candidate_primo = {
					OR = {
						leads_faction = faction_glory
						in_faction = faction_glory
					}
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_prosperity
					in_faction = faction_prosperity
				}
				event_target:candidate_primo = {
					OR = {
						leads_faction = faction_prosperity
						in_faction = faction_prosperity
					}
				}
			}
			modifier = {
				factor = 1.5
				FROM = {
					primary_title = {
						OR = {
							title = e_roman_empire
							title = e_byzantium
						}
					}
				}
				event_target:candidate_primo = {
					trait = born_in_the_purple
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = { which = "votes_for_primo" value = 1 }
				change_variable = { which = "votes_against_heir" value = 1 }
			}
		}
		event_target:candidate_primo = {
			custom_tooltip = { text = ENDORSE_FOR_SUCCESSION }
		}
		if = {
			limit = { NOT = { character = event_target:candidate_primo } }
			opinion = { who = event_target:candidate_primo modifier = supported_in_succession years = 5 }
			reverse_opinion = { who = event_target:candidate_primo modifier = supported_in_succession multiplier = 2 years = 5 }
		}
	}
	option = {
		name = EVTOPTF_Plus_1612 #Support senior candidate
		trigger = {
			event_target:candidate_senior = { is_alive = yes }
			vassal_of = FROM
			higher_tier_than = COUNT
			has_regent = no
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				event_target:candidate_senior = {
					NOT = { same_realm = FROM }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_senior = { is_adult = no }
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_tradition
					in_faction = faction_tradition
				}
			}
			modifier = {
				factor = 0.75
				is_female = no
				not_is_feminist_trigger = yes
				event_target:candidate_senior = {
					is_female = yes
					FROM = {
						primary_title = {
							OR = {
								has_law = cognatic_succession
								has_law = true_cognatic_succession
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.5
				is_female = no
				not_is_feminist_trigger = yes
				event_target:candidate_senior = {
					is_female = yes
					FROM = {
						primary_title = {
							NOR = {
								has_law = cognatic_succession
								has_law = true_cognatic_succession
							}
						}
					}
				}
			}
			modifier = {
				factor = 0
				OR = {
					character = event_target:candidate_second_heir
					character = event_target:candidate_male
					character = event_target:candidate_female
					character = event_target:candidate_senior
					character = event_target:candidate_ability
				}
				NOR = {
					trait = content
					trait = humble
				}
			}
			modifier = {
				factor = 0.5
				NOT = { dynasty = event_target:candidate_senior }
			}
			modifier = {
				factor = 1.5
				is_close_relative = event_target:candidate_senior
			}
			modifier = {
				factor = 2.0
				OR = {
					is_child_of = event_target:candidate_senior
					is_father = event_target:candidate_senior
					is_mother = event_target:candidate_senior
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_senior = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 20 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_senior = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 30 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_senior = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 40 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_senior = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 50 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_senior = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = FROM second = PREV value = 10 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_senior = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = FROM second = PREV value = 20 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				NOT = { religion = event_target:candidate_senior }
			}
			modifier = {
				factor = 0.75
				NOT = { culture = event_target:candidate_senior }
			}
			modifier = {
				factor = 0.75
				NOT = { culture_group = event_target:candidate_senior }
			}
			modifier = {
				factor = 1.2
				event_target:candidate_senior = {
					attribute_diff = { character = FROM attribute = diplomacy value = 3 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_senior = {
					attribute_diff = { character = FROM attribute = diplomacy value = 5 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_senior = {
					attribute_diff = { character = FROM attribute = diplomacy value = 7 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_senior = {
					attribute_diff = { character = FROM attribute = diplomacy value = 9 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_senior attribute = diplomacy value = 1 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_senior attribute = diplomacy value = 3 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_senior attribute = diplomacy value = 5 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_senior attribute = diplomacy value = 7 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_senior attribute = diplomacy value = 9 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_senior = {
					attribute_diff = { character = FROM attribute = martial value = 5 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_senior = {
					attribute_diff = { character = FROM attribute = martial value = 10 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_senior attribute = martial value = 5 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_senior attribute = martial value = 10 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_senior = {
					attribute_diff = { character = FROM attribute = stewardship value = 5 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_senior = {
					attribute_diff = { character = FROM attribute = stewardship value = 10 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_senior attribute = stewardship value = 5 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_senior attribute = stewardship value = 10 }
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_court
					in_faction = faction_court
				}
				event_target:candidate_senior = {
					OR = {
						leads_faction = faction_court
						in_faction = faction_court
					}
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_glory
					in_faction = faction_glory
				}
				event_target:candidate_senior = {
					OR = {
						leads_faction = faction_glory
						in_faction = faction_glory
					}
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_prosperity
					in_faction = faction_prosperity
				}
				event_target:candidate_senior = {
					OR = {
						leads_faction = faction_prosperity
						in_faction = faction_prosperity
					}
				}
			}
			modifier = {
				factor = 1.5
				FROM = {
					primary_title = {
						OR = {
							title = e_roman_empire
							title = e_byzantium
						}
					}
				}
				event_target:candidate_senior = {
					trait = born_in_the_purple
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = { which = "votes_for_senior" value = 1 }
				change_variable = { which = "votes_against_heir" value = 1 }
			}
		}
		event_target:candidate_senior = {
			custom_tooltip = { text = ENDORSE_FOR_SUCCESSION }
		}
		if = {
			limit = { NOT = { character = event_target:candidate_senior } }
			opinion = { who = event_target:candidate_senior modifier = supported_in_succession years = 5 }
			reverse_opinion = { who = event_target:candidate_senior modifier = supported_in_succession multiplier = 2 years = 5 }
		}
	}
	option = {
		name = EVTOPTG_Plus_1612 #Support ability candidate
		trigger = {
			event_target:candidate_ability = { is_alive = yes }
			vassal_of = FROM
			higher_tier_than = COUNT
			has_regent = no
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0.5
				event_target:candidate_ability = {
					NOT = { same_realm = FROM }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_ability = { is_adult = no }
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_tradition
					in_faction = faction_tradition
				}
			}
			modifier = {
				factor = 0.75
				is_female = no
				not_is_feminist_trigger = yes
				event_target:candidate_ability = {
					is_female = yes
					FROM = {
						primary_title = {
							OR = {
								has_law = cognatic_succession
								has_law = true_cognatic_succession
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.5
				is_female = no
				not_is_feminist_trigger = yes
				event_target:candidate_ability = {
					is_female = yes
					FROM = {
						primary_title = {
							NOR = {
								has_law = cognatic_succession
								has_law = true_cognatic_succession
							}
						}
					}
				}
			}
			modifier = {
				factor = 0
				OR = {
					character = event_target:candidate_second_heir
					character = event_target:candidate_male
					character = event_target:candidate_female
					character = event_target:candidate_senior
					character = event_target:candidate_ability
				}
				NOR = {
					trait = content
					trait = humble
				}
			}
			modifier = {
				factor = 0.5
				NOT = { dynasty = event_target:candidate_ability }
			}
			modifier = {
				factor = 1.5
				is_close_relative = event_target:candidate_ability
			}
			modifier = {
				factor = 2.0
				OR = {
					is_child_of = event_target:candidate_ability
					is_father = event_target:candidate_ability
					is_mother = event_target:candidate_ability
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_ability = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 20 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_ability = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 30 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_ability = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 40 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_ability = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = PREV second = FROM value = 50 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_ability = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = FROM second = PREV value = 10 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				event_target:candidate_ability = {
					NOT = { character = ROOT }
					ROOT = { opinion_diff = { first = FROM second = PREV value = 20 as_if_liege = yes } }
				}
			}
			modifier = {
				factor = 0.5
				NOT = { religion = event_target:candidate_ability }
			}
			modifier = {
				factor = 0.75
				NOT = { culture = event_target:candidate_ability }
			}
			modifier = {
				factor = 0.75
				NOT = { culture_group = event_target:candidate_ability }
			}
			modifier = {
				factor = 1.2
				event_target:candidate_ability = {
					attribute_diff = { character = FROM attribute = diplomacy value = 3 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_ability = {
					attribute_diff = { character = FROM attribute = diplomacy value = 5 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_ability = {
					attribute_diff = { character = FROM attribute = diplomacy value = 7 }
				}
			}
			modifier = {
				factor = 1.2
				event_target:candidate_ability = {
					attribute_diff = { character = FROM attribute = diplomacy value = 9 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_ability attribute = diplomacy value = 1 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_ability attribute = diplomacy value = 3 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_ability attribute = diplomacy value = 5 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_ability attribute = diplomacy value = 7 }
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					attribute_diff = { character = event_target:candidate_ability attribute = diplomacy value = 9 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_ability = {
					attribute_diff = { character = FROM attribute = martial value = 5 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_ability = {
					attribute_diff = { character = FROM attribute = martial value = 10 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_ability attribute = martial value = 5 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_ability attribute = martial value = 10 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_ability = {
					attribute_diff = { character = FROM attribute = stewardship value = 5 }
				}
			}
			modifier = {
				factor = 1.25
				event_target:candidate_ability = {
					attribute_diff = { character = FROM attribute = stewardship value = 10 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_ability attribute = stewardship value = 5 }
				}
			}
			modifier = {
				factor = 0.75
				FROM = {
					attribute_diff = { character = event_target:candidate_ability attribute = stewardship value = 10 }
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_court
					in_faction = faction_court
				}
				event_target:candidate_ability = {
					OR = {
						leads_faction = faction_court
						in_faction = faction_court
					}
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_glory
					in_faction = faction_glory
				}
				event_target:candidate_ability = {
					OR = {
						leads_faction = faction_glory
						in_faction = faction_glory
					}
				}
			}
			modifier = {
				factor = 1.25
				OR = {
					leads_faction = faction_prosperity
					in_faction = faction_prosperity
				}
				event_target:candidate_ability = {
					OR = {
						leads_faction = faction_prosperity
						in_faction = faction_prosperity
					}
				}
			}
			modifier = {
				factor = 1.5
				FROM = {
					primary_title = {
						OR = {
							title = e_roman_empire
							title = e_byzantium
						}
					}
				}
				event_target:candidate_ability = {
					trait = born_in_the_purple
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				change_variable = { which = "votes_for_ability" value = 1 }
				change_variable = { which = "votes_against_heir" value = 1 }
			}
		}
		event_target:candidate_ability = {
			custom_tooltip = { text = ENDORSE_FOR_SUCCESSION }
		}
		if = {
			limit = { NOT = { character = event_target:candidate_ability } }
			opinion = { who = event_target:candidate_ability modifier = supported_in_succession years = 5 }
			reverse_opinion = { who = event_target:candidate_ability modifier = supported_in_succession multiplier = 2 years = 5 }
		}
	}
	option = {
		name = EVTOPTH_Plus_1612
		trigger = {
			NOT = {
				AND = {
					vassal_of = FROM
					higher_tier_than = COUNT
					has_regent = no
				}
			}
		}
	}
}

# Bounce event to check if the ruler won or not
character_event = {
	id = Plus.1613
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		primary_title = {
			higher_tier_than = DUKE
			has_title_flag = will_be_inherited
		}
		NOR = {
			trait = rebel
			any_demesne_title = { is_contested = yes }
			any_demesne_title = { temporary = yes }
			has_character_flag = faction_court_war
			has_character_flag = faction_prosperity_war
			has_character_flag = faction_glory_war
			has_character_flag = faction_tradition_war
			has_character_flag = faction_separatist_war
			has_character_flag = faction_pretender_war
			has_character_flag = faction_religious_war
		}
	}
	
	immediate = {
		#see if the ruler won
		if = {
			limit = {
				NOT = { check_variable = { which = "votes_against_heir" which = "votes_for_heir" } }
				check_variable = { which = "votes_for_heir" which = "votes_for_second_heir" }
				check_variable = { which = "votes_for_heir" which = "votes_for_male" }
				check_variable = { which = "votes_for_heir" which = "votes_for_female" }
				check_variable = { which = "votes_for_heir" which = "votes_for_primo" }
				check_variable = { which = "votes_for_heir" which = "votes_for_senior" }
				check_variable = { which = "votes_for_heir" which = "votes_for_ability" }
			}
			narrative_event = { id = Plus.1614 }
			break = yes
		}
		#see if the second_heir won
		if = {
			limit = {
				check_variable = { which = "votes_for_second_heir" which = "votes_for_heir" }
				check_variable = { which = "votes_for_second_heir" which = "votes_for_male" }
				check_variable = { which = "votes_for_second_heir" which = "votes_for_female" }
				check_variable = { which = "votes_for_second_heir" which = "votes_for_primo" }
				check_variable = { which = "votes_for_second_heir" which = "votes_for_senior" }
				check_variable = { which = "votes_for_second_heir" which = "votes_for_ability" }
			}
			event_target:candidate_second_heir = { save_event_target_as = succession_winner }
			narrative_event = { id = Plus.1615 }
			break = yes
		}
		#see if the male candidate won
		if = {
			limit = {
				check_variable = { which = "votes_for_male" which = "votes_for_heir" }
				check_variable = { which = "votes_for_male" which = "votes_for_second_heir" }
				check_variable = { which = "votes_for_male" which = "votes_for_female" }
				check_variable = { which = "votes_for_male" which = "votes_for_primo" }
				check_variable = { which = "votes_for_male" which = "votes_for_senior" }
				check_variable = { which = "votes_for_male" which = "votes_for_ability" }
			}
			event_target:candidate_male = { save_event_target_as = succession_winner }
			narrative_event = { id = Plus.1615 }
			break = yes
		}
		#see if the female candidate won
		if = {
			limit = {
				check_variable = { which = "votes_for_female" which = "votes_for_heir" }
				check_variable = { which = "votes_for_female" which = "votes_for_second_heir" }
				check_variable = { which = "votes_for_female" which = "votes_for_male" }
				check_variable = { which = "votes_for_female" which = "votes_for_primo" }
				check_variable = { which = "votes_for_female" which = "votes_for_senior" }
				check_variable = { which = "votes_for_female" which = "votes_for_ability" }
			}
			event_target:candidate_female = { save_event_target_as = succession_winner }
			narrative_event = { id = Plus.1615 }
			break = yes
		}
		#see if the primo candidate won
		if = {
			limit = {
				check_variable = { which = "votes_for_primo" which = "votes_for_heir" }
				check_variable = { which = "votes_for_primo" which = "votes_for_second_heir" }
				check_variable = { which = "votes_for_primo" which = "votes_for_male" }
				check_variable = { which = "votes_for_primo" which = "votes_for_female" }
				check_variable = { which = "votes_for_primo" which = "votes_for_senior" }
				check_variable = { which = "votes_for_primo" which = "votes_for_ability" }
			}
			event_target:candidate_primo = { save_event_target_as = succession_winner }
			narrative_event = { id = Plus.1615 }
			break = yes
		}
		#see if seniority candidate won
		if = {
			limit = {
				check_variable = { which = "votes_for_senior" which = "votes_for_heir" }
				check_variable = { which = "votes_for_senior" which = "votes_for_second_heir" }
				check_variable = { which = "votes_for_senior" which = "votes_for_male" }
				check_variable = { which = "votes_for_senior" which = "votes_for_female" }
				check_variable = { which = "votes_for_senior" which = "votes_for_primo" }
				check_variable = { which = "votes_for_senior" which = "votes_for_ability" }
			}
			event_target:candidate_senior = { save_event_target_as = succession_winner }
			narrative_event = { id = Plus.1615 }
			break = yes
		}
		#see if ability candidate won
		if = {
			limit = {
				check_variable = { which = "votes_for_ability" which = "votes_for_heir" }
				check_variable = { which = "votes_for_ability" which = "votes_for_second_heir" }
				check_variable = { which = "votes_for_ability" which = "votes_for_male" }
				check_variable = { which = "votes_for_ability" which = "votes_for_female" }
				check_variable = { which = "votes_for_ability" which = "votes_for_primo" }
				check_variable = { which = "votes_for_ability" which = "votes_for_senior" }
			}
			event_target:candidate_ability = { save_event_target_as = succession_winner }
			narrative_event = { id = Plus.1615 }
			break = yes
		}
		#otherwise there is a stalemate
		narrative_event = { id = Plus.1616 }
	}
}

# The original heir wins decisively
narrative_event = {
	id = Plus.1614
	title = EVTNAME_Plus_1611
	desc = EVTDESC_Plus_1614
	picture = GFX_evt_coronation

	is_triggered_only = yes
	major = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
			dynasty = ROOT
		}
	}
	
	option = {
		name = EXCELLENT
		trigger = {
			character = ROOT
		}
		prestige = 100
		add_character_modifier = {
			name = won_succession
			duration = 730
		}
		any_vassal = {
			limit = {
				OR = {
					has_any_opinion_modifier = supported_in_succession
					character = event_target:candidate_second_heir
					character = event_target:candidate_male
					character = event_target:candidate_female
					character = event_target:candidate_primo
					character = event_target:candidate_senior
					character = event_target:candidate_ability
				}
			}
			if = {
				limit = { has_opinion_modifier = { who = ROOT modifier = supported_in_succession } }
				custom_tooltip = { text = SUPPORTED_HEIR }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_second_heir modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_second_heir
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_SECOND_HEIR }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_male modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_male
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_MALE }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_female modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_female
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_FEMALE }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_primo modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_primo
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_PRIMO }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_senior modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_senior
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_SENIOR }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_ability modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_ability
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_ABILITY }
			}
		}
		hidden_tooltip = {
			any_demesne_title = {
				limit = { has_title_flag = will_be_inherited }
				clr_title_flag = will_be_inherited
			}
		}
	}
	option = {
		name = CURSES
		trigger = {
			OR = {
				character = event_target:candidate_second_heir
				character = event_target:candidate_male
				character = event_target:candidate_female
				character = event_target:candidate_primo
				character = event_target:candidate_senior
				character = event_target:candidate_ability
			}
		}
		ROOT = {
			any_vassal = {
				limit = {
					OR = {
						has_any_opinion_modifier = supported_in_succession
						character = event_target:candidate_second_heir
						character = event_target:candidate_male
						character = event_target:candidate_female
						character = event_target:candidate_primo
						character = event_target:candidate_senior
						character = event_target:candidate_ability
					}
				}
				if = {
					limit = { has_opinion_modifier = { who = ROOT modifier = supported_in_succession } }
					custom_tooltip = { text = SUPPORTED_HEIR }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_second_heir modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_second_heir
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_SECOND_HEIR }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_male modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_male
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_MALE }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_female modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_female
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_FEMALE }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_primo modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_primo
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_PRIMO }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_senior modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_senior
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_SENIOR }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_ability modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_ability
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_ABILITY }
				}
			}
		}
	}
	option = {
		name = OK
		trigger = {
			NOR = {
				character = ROOT
				character = event_target:candidate_second_heir
				character = event_target:candidate_male
				character = event_target:candidate_female
				character = event_target:candidate_primo
				character = event_target:candidate_senior
				character = event_target:candidate_ability
			}
		}
	}
}

# The original heir loses
narrative_event = {
	id = Plus.1615
	title = EVTNAME_Plus_1611
	desc = EVTDESC_Plus_1615
	picture = GFX_evt_coronation

	is_triggered_only = yes
	major = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
			dynasty = ROOT
		}
	}
	
	option = {
		name = CURSES
		trigger = {
			character = ROOT
		}
		set_character_flag = justified_claimant
		prestige = -250
		tooltip = {
			event_target:succession_winner = {
				ROOT = {
					primary_title = {
						usurp_title_plus_barony_if_unlanded = PREVPREV
					}
				}
			}
		}
		any_vassal = {
			limit = {
				OR = {
					has_any_opinion_modifier = supported_in_succession
					character = event_target:candidate_second_heir
					character = event_target:candidate_male
					character = event_target:candidate_female
					character = event_target:candidate_primo
					character = event_target:candidate_senior
					character = event_target:candidate_ability
				}
			}
			if = {
				limit = { has_opinion_modifier = { who = ROOT modifier = supported_in_succession } }
				custom_tooltip = { text = SUPPORTED_HEIR }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_second_heir modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_second_heir
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_SECOND_HEIR }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_male modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_male
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_MALE }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_female modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_female
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_FEMALE }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_primo modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_primo
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_PRIMO }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_senior modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_senior
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_SENIOR }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_ability modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_ability
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_ABILITY }
			}
		}
		hidden_tooltip = {
			if = {
				limit = { independent = no }
				liege = { save_event_target_as = former_liege }
			}
			if = {
				limit = {
					event_target:succession_winner = {
						independent = no
						is_ruler = yes
						higher_real_tier_than = DUKE
						liege = { NOT = { character = event_target:former_liege } }
					}
				}
				event_target:succession_winner = { liege = { save_event_target_as = winner_former_liege } }
			}
			if = {
				limit = {
					event_target:succession_winner = {
						is_ruler = yes
						OR = {
							is_theocracy = yes
							is_republic = yes
						}
					}
					ROOT = {
						primary_title = { higher_tier_than = event_target:succession_winner }
					}
				}
				event_target:succession_winner = { abdicate = yes }
			}
			event_target:succession_winner = {
				prestige = 100
				add_character_modifier = {
					name = won_succession
					duration = 730
				}
				ROOT = {
					if = {
						limit = {
							event_target:succession_winner = { is_ruler = yes }
							any_demesne_title = {
								has_title_flag = will_be_inherited
								higher_tier_than = DUKE
								has_law = succ_feudal_elective
							}
						}
						any_demesne_title = {
							limit = {
								has_title_flag = will_be_inherited
								higher_tier_than = DUKE
							}
							clr_title_flag = will_be_inherited
							usurp_title_plus_barony_if_unlanded = { target = PREVPREV type = faction_demand }
						}
						any_demesne_title = {
							limit = { has_title_flag = will_be_inherited }
							clr_title_flag = will_be_inherited
						}
					}
					if = {
						limit = {
							OR = {
								event_target:succession_winner = { is_ruler = no }
								NOT = {
									any_demesne_title = {
										has_title_flag = will_be_inherited
										higher_tier_than = DUKE
										has_law = succ_feudal_elective
									}
								}
							}
						}
						any_demesne_title = {
							limit = { has_title_flag = will_be_inherited }
							clr_title_flag = will_be_inherited
							usurp_title_plus_barony_if_unlanded = { target = PREVPREV type = faction_demand }
						}
					}
					set_defacto_liege = PREV
					any_vassal = {
						limit = { NOT = { primary_title = { de_jure_liege_or_above = PREVPREV } } }
						set_defacto_liege = PREVPREV 
					}
				}
			}
			if = {
				limit = {
					event_target:former_liege = { always = yes }
				}
				event_target:former_liege = {
					event_target:succession_winner = { set_defacto_liege = PREV }
				}
			}
			if = {
				limit = {
					event_target:winner_former_liege = { always = yes }
				}
				event_target:winner_former_liege = {
					event_target:succession_winner = { set_defacto_liege = PREV }
				}
			}
			if = {
				limit = {
					event_target:candidate_second_heir = { NOT = { character = event_target:succession_winner } }
					check_variable = { which = "votes_for_second_heir" value = 1.5 }
				}
				event_target:candidate_second_heir = { set_character_flag = justified_claimant }
			}
			if = {
				limit = {
					event_target:candidate_male = { NOT = { character = event_target:succession_winner } }
					check_variable = { which = "votes_for_male" value = 1.5 }
				}
				event_target:candidate_male = { set_character_flag = justified_claimant }
			}
			if = {
				limit = {
					event_target:candidate_female = { NOT = { character = event_target:succession_winner } }
					check_variable = { which = "votes_for_female" value = 1.5 }
				}
				event_target:candidate_female = { set_character_flag = justified_claimant }
			}
			if = {
				limit = {
					event_target:candidate_primo = { NOT = { character = event_target:succession_winner } }
					check_variable = { which = "votes_for_primo" value = 1.5 }
				}
				event_target:candidate_primo = { set_character_flag = justified_claimant }
			}
			if = {
				limit = {
					event_target:candidate_senior = { NOT = { character = event_target:succession_winner } }
					check_variable = { which = "votes_for_senior" value = 1.5 }
				}
				event_target:candidate_senior = { set_character_flag = justified_claimant }
			}
			if = {
				limit = {
					event_target:candidate_ability = { NOT = { character = event_target:succession_winner } }
					check_variable = { which = "votes_for_ability" value = 1.5 }
				}
				event_target:candidate_ability = { set_character_flag = justified_claimant }
			}
		}
	}
	option = {
		name = EXCELLENT
		trigger = {
			character = event_target:succession_winner
		}
		ROOT = {
			any_vassal = {
				limit = {
					OR = {
						has_any_opinion_modifier = supported_in_succession
						character = event_target:candidate_second_heir
						character = event_target:candidate_male
						character = event_target:candidate_female
						character = event_target:candidate_primo
						character = event_target:candidate_senior
						character = event_target:candidate_ability
					}
				}
				if = {
					limit = { has_opinion_modifier = { who = ROOT modifier = supported_in_succession } }
					custom_tooltip = { text = SUPPORTED_HEIR }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_second_heir modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_second_heir
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_SECOND_HEIR }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_male modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_male
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_MALE }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_female modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_female
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_FEMALE }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_primo modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_primo
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_PRIMO }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_senior modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_senior
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_SENIOR }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_ability modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_ability
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_ABILITY }
				}
			}
		}
	}
	option = {
		name = CURSES
		trigger = {
			NOT = { character = event_target:succession_winner }
			OR = {
				character = event_target:candidate_second_heir
				character = event_target:candidate_male
				character = event_target:candidate_female
				character = event_target:candidate_primo
				character = event_target:candidate_senior
				character = event_target:candidate_ability
			}
		}
		ROOT = {
			any_vassal = {
				limit = {
					OR = {
						has_any_opinion_modifier = supported_in_succession
						character = event_target:candidate_second_heir
						character = event_target:candidate_male
						character = event_target:candidate_female
						character = event_target:candidate_primo
						character = event_target:candidate_senior
						character = event_target:candidate_ability
					}
				}
				if = {
					limit = { has_opinion_modifier = { who = ROOT modifier = supported_in_succession } }
					custom_tooltip = { text = SUPPORTED_HEIR }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_second_heir modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_second_heir
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_SECOND_HEIR }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_male modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_male
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_MALE }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_female modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_female
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_FEMALE }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_primo modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_primo
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_PRIMO }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_senior modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_senior
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_SENIOR }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_ability modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_ability
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_ABILITY }
				}
			}
		}
	}
	option = {
		name = OK
		trigger = {
			NOR = {
				character = ROOT
				character = event_target:candidate_second_heir
				character = event_target:candidate_male
				character = event_target:candidate_female
				character = event_target:candidate_primo
				character = event_target:candidate_senior
				character = event_target:candidate_ability
			}
		}
	}
}

# Nobody wins the crisis -- it stalls
narrative_event = {
	id = Plus.1616
	title = EVTNAME_Plus_1611
	desc = EVTDESC_Plus_1616
	picture = GFX_evt_coronation

	is_triggered_only = yes
	major = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
			dynasty = ROOT
		}
	}
	
	option = {
		name = OK
		trigger = {
			character = ROOT
		}
		prestige = -100
		hidden_tooltip = {
			any_demesne_title = {
				limit = { has_title_flag = will_be_inherited }
				clr_title_flag = will_be_inherited
			}
			event_target:candidate_second_heir = { set_character_flag = justified_claimant }
			event_target:candidate_male = { set_character_flag = justified_claimant }
			event_target:candidate_female = { set_character_flag = justified_claimant }
			event_target:candidate_primo = { set_character_flag = justified_claimant }
			event_target:candidate_senior = { set_character_flag = justified_claimant }
			event_target:candidate_ability = { set_character_flag = justified_claimant }
		}
		any_vassal = {
			limit = {
				OR = {
					has_any_opinion_modifier = supported_in_succession
					character = event_target:candidate_second_heir
					character = event_target:candidate_male
					character = event_target:candidate_female
					character = event_target:candidate_primo
					character = event_target:candidate_senior
					character = event_target:candidate_ability
				}
			}
			if = {
				limit = { has_opinion_modifier = { who = ROOT modifier = supported_in_succession } }
				custom_tooltip = { text = SUPPORTED_HEIR }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_second_heir modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_second_heir
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_SECOND_HEIR }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_male modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_male
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_MALE }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_female modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_female
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_FEMALE }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_primo modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_primo
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_PRIMO }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_senior modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_senior
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_SENIOR }
			}
			if = {
				limit = {
					OR = {
						has_opinion_modifier = { who = event_target:candidate_ability modifier = supported_in_succession }
						AND = {
							character = event_target:candidate_ability
							NOT = { has_any_opinion_modifier = supported_in_succession }
						}
					}
				}
				custom_tooltip = { text = SUPPORTED_ABILITY }
			}
		}
	}
	option = {
		name = CURSES
		trigger = {
			OR = {
				character = event_target:candidate_second_heir
				character = event_target:candidate_male
				character = event_target:candidate_female
				character = event_target:candidate_primo
				character = event_target:candidate_senior
				character = event_target:candidate_ability
			}
		}
		ROOT = {
			any_vassal = {
				limit = {
					OR = {
						has_any_opinion_modifier = supported_in_succession
						character = event_target:candidate_second_heir
						character = event_target:candidate_male
						character = event_target:candidate_female
						character = event_target:candidate_primo
						character = event_target:candidate_senior
						character = event_target:candidate_ability
					}
				}
				if = {
					limit = { has_opinion_modifier = { who = ROOT modifier = supported_in_succession } }
					custom_tooltip = { text = SUPPORTED_HEIR }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_second_heir modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_second_heir
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_SECOND_HEIR }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_male modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_male
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_MALE }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_female modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_female
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_FEMALE }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_primo modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_primo
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_PRIMO }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_senior modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_senior
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_SENIOR }
				}
				if = {
					limit = {
						OR = {
							has_opinion_modifier = { who = event_target:candidate_ability modifier = supported_in_succession }
							AND = {
								character = event_target:candidate_ability
								NOT = { has_any_opinion_modifier = supported_in_succession }
							}
						}
					}
					custom_tooltip = { text = SUPPORTED_ABILITY }
				}
			}
		}
	}
	option = {
		name = OK
		trigger = {
			NOR = {
				character = ROOT
				character = event_target:candidate_second_heir
				character = event_target:candidate_male
				character = event_target:candidate_female
				character = event_target:candidate_primo
				character = event_target:candidate_senior
				character = event_target:candidate_ability
			}
		}
	}
}

# The succession crisis is averted due to war
character_event = {
	id = Plus.1617
	desc = EVTDESC_Plus_1617
	picture = GFX_evt_coronation
	
	is_triggered_only = yes
	major = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
			dynasty = ROOT
		}
	}
	
	trigger = {
		OR = {
			trait = rebel
			any_demesne_title = { is_contested = yes }
			any_demesne_title = { temporary = yes }
			has_character_flag = faction_court_war
			has_character_flag = faction_prosperity_war
			has_character_flag = faction_glory_war
			has_character_flag = faction_tradition_war
			has_character_flag = faction_separatist_war
			has_character_flag = faction_pretender_war
			has_character_flag = faction_religious_war
		}
	}
	
	option = {
		name = EVTOPTA_Plus_1617
		trigger = { character = ROOT }
		hidden_tooltip = {
			any_demesne_title = {
				limit = { has_title_flag = will_be_inherited }
				clr_title_flag = will_be_inherited
			}
			event_target:candidate_second_heir = { set_character_flag = justified_claimant }
			event_target:candidate_male = { set_character_flag = justified_claimant }
			event_target:candidate_female = { set_character_flag = justified_claimant }
			event_target:candidate_primo = { set_character_flag = justified_claimant }
			event_target:candidate_senior = { set_character_flag = justified_claimant }
			event_target:candidate_ability = { set_character_flag = justified_claimant }
		}
	}
	option = {
		name = OK
		trigger = { NOT = { character = ROOT } }
	}
}

######################################
# TITLE DESTRUCTION EVENTS
# Written by Rylock
######################################

# Crown is under threat of destruction following revolt
character_event = {
	id = Plus.1620
	title = EVTNAME_Plus_1620
	desc = EVTDESC_Plus_1620
	picture = GFX_evt_royal_court
	
	is_triggered_only = yes
	hide_from = yes
	
	trigger = {
		primary_title = { has_title_flag = destroy_title }
	}
	
	immediate = {
		primary_title = {
			save_event_target_as = threatened_title
			clr_title_flag = destroy_title
		}
	}
	
	option = {
		name = EVTOPTA_Plus_1620 # Save the title
		trigger = {
			prestige = 0
			wealth = 0
			OR = {
				AND = {
					event_target:threatened_title = { tier = KING }
					wealth = 250
				}
				AND = {
					event_target:threatened_title = { tier = EMPEROR }
					wealth = 500
				}
				AND = {
					ai = no
					NOT = { has_character_flag = loan_taken }
					NOT = { has_character_flag = offended_moneylenders }
				}
				AND = {
					ai = yes
					NOT = { check_variable = { which = "loan_amount" value = 49.5 } }
				}
			}
		}
		log = "The [Root.PrimaryTitle.GetFullName] was threatened with destruction, but was rescued by [Root.GetTitledName]"
		ai_chance = {
			factor = 100
		}
		if = {
			limit = { event_target:threatened_title = { tier = KING } }
			wealth = -250
			prestige = -500
		}
		if = {
			limit = { event_target:threatened_title = { tier = EMPEROR } }
			wealth = -500
			prestige = -1250
		}
	}
	option = {
		name = EVTOPTB_Plus_1620 # There is nothing I can do
		ai_chance = {
			factor = 0
		}
		log = "The [Root.PrimaryTitle.GetFullName] has been destroyed after its Crown Authority fell too low"
		tooltip = {
			event_target:threatened_title = { destroy_landed_title = THIS }
		}
		hidden_tooltip = {
			narrative_event = { id = Plus.1621 }
		}
	}
}

# Primary title is destroyed due to loss of crown authority
narrative_event = {
	id = Plus.1621
	title = EVTNAME_Plus_1620
	desc = EVTDESC_Plus_1621
	picture = GFX_evt_royal_court	

	is_triggered_only = yes
	major = yes
	hide_from = yes
	show_ROOT = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
			has_claim = event_target:threatened_title
			capital_scope = {
				ROOT = {
					capital_scope = {
						NOT = {
							distance = {
								where = PREVPREV
								value = 600	# Same part of the world
							}
						}
					}
				}
			}
		}
	}
	
	option = {
		name = CURSES
		trigger = { character = ROOT }
		if = {
			limit = {
				any_demesne_title = {
					NOT = { title = event_target:threatened_title }
					tier = KING
				}
			}
			any_vassal = {
				limit = { higher_tier_than = DUKE }
				primary_title = { add_pressed_claim = ROOT }
			}
		}
		if = {
			limit = {
				NOT = {
					any_demesne_title = {
						NOT = { title = event_target:threatened_title }
						tier = KING
					}
				}
				any_demesne_title = {
					NOT = { title = event_target:threatened_title }
					tier = DUKE
				}
			}
			any_vassal = {
				limit = { higher_tier_than = COUNT }
				primary_title = { add_pressed_claim = ROOT }
			}
		}
		if = {
			limit = {
				NOT = {
					any_demesne_title = {
						NOT = { title = event_target:threatened_title }
						higher_tier_than = COUNT
					}
				}
			}
			any_vassal = {
				limit = { higher_tier_than = BARON }
				primary_title = { add_pressed_claim = ROOT }
			}
		}
		hidden_tooltip = {
			event_target:threatened_title = { destroy_landed_title = THIS }
		}
	}
	option = {
		name = I_SEE
		trigger = {
			NOT = { character = ROOT }
			religion_group = ROOT
		}
	}
	option = {
		name = EVTOPTA_Plus_1621
		trigger = {
			NOT = { character = ROOT }
			NOT = { religion_group = ROOT }
		}
	}
}
	
