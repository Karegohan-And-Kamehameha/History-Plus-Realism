namespace = PlusFaction

#reserved: PlusFaction.200 to PlusFaction.299

##################################
# FACTION MAINTENANCE EVENTS
# Original Faction System by Wiz
# Re-Written by Rylock
##################################

# Main faction maintenance event
character_event = {
	id = PlusFaction.200
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		is_nomadic = no
		higher_tier_than = COUNT
		num_of_vassals = 1
		any_vassal = {
			OR = {
				leads_faction = faction_court
				leads_faction = faction_prosperity
				leads_faction = faction_glory
				leads_faction = faction_tradition
			}
		}
	}

	immediate = {
		#reset variables
		set_variable = { which = "faction_votes_court" value = 0 }
		set_variable = { which = "faction_votes_prosperity" value = 0 }
		set_variable = { which = "faction_votes_glory" value = 0 }
		set_variable = { which = "faction_votes_tradition" value = 0 }
		set_variable = { which = "faction_mood_court" value = 0 }
		set_variable = { which = "faction_mood_prosperity" value = 0 }
		set_variable = { which = "faction_mood_glory" value = 0 }
		set_variable = { which = "faction_mood_tradition" value = 0 }
		
		#count the number of votes in each faction
		any_vassal = {
			if = {
				limit = {
					OR = {
						leads_faction = faction_court
						in_faction = faction_court
					}
				}
				if = {
					limit = { real_tier = BARON }
					ROOT = { change_variable = { which = "faction_votes_court" value = 1 } }
				}
				if = {
					limit = { real_tier = COUNT }
					ROOT = { change_variable = { which = "faction_votes_court" value = 2 } }
				}
				if = {
					limit = { real_tier = DUKE }
					ROOT = { change_variable = { which = "faction_votes_court" value = 4 } }
				}
				if = {
					limit = { real_tier = KING }
					ROOT = { change_variable = { which = "faction_votes_court" value = 8 } }
				}
			}
			if = {
				limit = {
					OR = {
						leads_faction = faction_prosperity
						in_faction = faction_prosperity
					}
				}
				if = {
					limit = { real_tier = BARON }
					ROOT = { change_variable = { which = "faction_votes_prosperity" value = 1 } }
				}
				if = {
					limit = { real_tier = COUNT }
					ROOT = { change_variable = { which = "faction_votes_prosperity" value = 2 } }
				}
				if = {
					limit = { real_tier = DUKE }
					ROOT = { change_variable = { which = "faction_votes_prosperity" value = 4 } }
				}
				if = {
					limit = { real_tier = KING }
					ROOT = { change_variable = { which = "faction_votes_prosperity" value = 8 } }
				}
			}
			if = {
				limit = {
					OR = {
						leads_faction = faction_glory
						in_faction = faction_glory
					}
				}
				if = {
					limit = { real_tier = BARON }
					ROOT = { change_variable = { which = "faction_votes_glory" value = 1 } }
				}
				if = {
					limit = { real_tier = COUNT }
					ROOT = { change_variable = { which = "faction_votes_glory" value = 2 } }
				}
				if = {
					limit = { real_tier = DUKE }
					ROOT = { change_variable = { which = "faction_votes_glory" value = 4 } }
				}
				if = {
					limit = { real_tier = KING }
					ROOT = { change_variable = { which = "faction_votes_glory" value = 8 } }
				}
			}
			if = {
				limit = {
					OR = {
						leads_faction = faction_tradition
						in_faction = faction_tradition
					}
				}
				if = {
					limit = { real_tier = BARON }
					ROOT = { change_variable = { which = "faction_votes_tradition" value = 1 } }
				}
				if = {
					limit = { real_tier = COUNT }
					ROOT = { change_variable = { which = "faction_votes_tradition" value = 2 } }
				}
				if = {
					limit = { real_tier = DUKE }
					ROOT = { change_variable = { which = "faction_votes_tradition" value = 4 } }
				}
				if = {
					limit = { real_tier = KING }
					ROOT = { change_variable = { which = "faction_votes_tradition" value = 8 } }
				}
			}
		}

		#remove any invalid faction opinion modifiers
		if = {
			limit = {
				NOR = {
					leads_faction = faction_court
					leads_faction = faction_prosperity
					leads_faction = faction_glory
					leads_faction = faction_tradition
				}
				OR = {
					check_variable = { which = "faction_mood_increase" value = 0.5 }
					check_variable = { which = "faction_mood_decrease" value = 0.5 }
				}
			}
			set_variable = { which = "faction_mood_increase" value = 0 }
			set_variable = { which = "faction_mood_decrease" value = 0 }
		}
		any_vassal = {
			limit = {
				NOR = {
					leads_faction = faction_court
					leads_faction = faction_prosperity
					leads_faction = faction_glory
					leads_faction = faction_tradition
				}
				OR = {
					check_variable = { which = "faction_mood_increase" value = 0.5 }
					check_variable = { which = "faction_mood_decrease" value = 0.5 }
				}
			}
			set_variable = { which = "faction_mood_increase" value = 0 }
			set_variable = { which = "faction_mood_decrease" value = 0 }
		}
		
		#make any one-time adjustments to faction opinions
		any_vassal = {
			limit = {
				OR = {
					leads_faction = faction_court
					leads_faction = faction_prosperity
					leads_faction = faction_glory
					leads_faction = faction_tradition
				}
				OR = {
					check_variable = { which = "faction_mood_increase" value = 0.5 }
					check_variable = { which = "faction_mood_decrease" value = 0.5 }
				}
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_increase" value = 1 } }
				opinion = { who = ROOT modifier = faction_pleased years = 3 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_increase" value = 2 } }
				opinion = { who = ROOT modifier = faction_pleased multiplier = 2 years = 3 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_increase" value = 3 } }
				opinion = { who = ROOT modifier = faction_pleased multiplier = 3 years = 3 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_increase" value = 4 } }
				opinion = { who = ROOT modifier = faction_pleased multiplier = 4 years = 3 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_increase" value = 5 } }
				opinion = { who = ROOT modifier = faction_pleased multiplier = 5 years = 3 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_increase" value = 6 } }
				opinion = { who = ROOT modifier = faction_pleased multiplier = 6 years = 3 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_increase" value = 7 } }
				opinion = { who = ROOT modifier = faction_pleased multiplier = 7 years = 3 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_increase" value = 8 } }
				opinion = { who = ROOT modifier = faction_pleased multiplier = 8 years = 3 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_increase" value = 9 } }
				opinion = { who = ROOT modifier = faction_pleased multiplier = 9 years = 3 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_increase" value = 10 } }
				opinion = { who = ROOT modifier = faction_pleased multiplier = 10 years = 3 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_decrease" value = 1 } }
				opinion = { who = ROOT modifier = faction_displeased years = 6 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_decrease" value = 2 } }
				opinion = { who = ROOT modifier = faction_displeased multiplier = 2 years = 6 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_decrease" value = 3 } }
				opinion = { who = ROOT modifier = faction_displeased multiplier = 3 years = 6 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_decrease" value = 4 } }
				opinion = { who = ROOT modifier = faction_displeased multiplier = 4 years = 6 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_decrease" value = 5 } }
				opinion = { who = ROOT modifier = faction_displeased multiplier = 5 years = 6 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_decrease" value = 6 } }
				opinion = { who = ROOT modifier = faction_displeased multiplier = 6 years = 6 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_decrease" value = 7 } }
				opinion = { who = ROOT modifier = faction_displeased multiplier = 7 years = 6 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_decrease" value = 8 } }
				opinion = { who = ROOT modifier = faction_displeased multiplier = 8 years = 6 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_decrease" value = 9 } }
				opinion = { who = ROOT modifier = faction_displeased multiplier = 9 years = 6 }
			}
			if = {
				limit = { is_variable_equal = { which = "faction_mood_decrease" value = 10 } }
				opinion = { who = ROOT modifier = faction_displeased multiplier = 10 years = 6 }
			}
			any_faction_backer = {
				limit = {
					OR = {
						AND = {
							PREV = { leads_faction = faction_court }
							in_faction = faction_court
						}
						AND = {
							PREV = { leads_faction = faction_prosperity }
							in_faction = faction_prosperity
						}
						AND = {
							PREV = { leads_faction = faction_glory }
							in_faction = faction_glory
						}
						AND = {
							PREV = { leads_faction = faction_tradition }
							in_faction = faction_tradition
						}
					}
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_increase" value = 1 } } }
					opinion = { who = ROOT modifier = faction_pleased years = 3 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_increase" value = 2 } } }
					opinion = { who = ROOT modifier = faction_pleased multiplier = 2 years = 3 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_increase" value = 3 } } }
					opinion = { who = ROOT modifier = faction_pleased multiplier = 3 years = 3 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_increase" value = 4 } } }
					opinion = { who = ROOT modifier = faction_pleased multiplier = 4 years = 3 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_increase" value = 5 } } }
					opinion = { who = ROOT modifier = faction_pleased multiplier = 5 years = 3 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_increase" value = 6 } } }
					opinion = { who = ROOT modifier = faction_pleased multiplier = 6 years = 3 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_increase" value = 7 } } }
					opinion = { who = ROOT modifier = faction_pleased multiplier = 7 years = 3 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_increase" value = 8 } } }
					opinion = { who = ROOT modifier = faction_pleased multiplier = 8 years = 3 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_increase" value = 9 } } }
					opinion = { who = ROOT modifier = faction_pleased multiplier = 9 years = 3 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_increase" value = 10 } } }
					opinion = { who = ROOT modifier = faction_pleased multiplier = 10 years = 3 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_decrease" value = 1 } } }
					opinion = { who = ROOT modifier = faction_displeased years = 6 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_decrease" value = 2 } } }
					opinion = { who = ROOT modifier = faction_displeased multiplier = 2 years = 6 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_decrease" value = 3 } } }
					opinion = { who = ROOT modifier = faction_displeased multiplier = 3 years = 6 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_decrease" value = 4 } } }
					opinion = { who = ROOT modifier = faction_displeased multiplier = 4 years = 6 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_decrease" value = 5 } } }
					opinion = { who = ROOT modifier = faction_displeased multiplier = 5 years = 6 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_decrease" value = 6 } } }
					opinion = { who = ROOT modifier = faction_displeased multiplier = 6 years = 6 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_decrease" value = 7 } } }
					opinion = { who = ROOT modifier = faction_displeased multiplier = 7 years = 6 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_decrease" value = 8 } } }
					opinion = { who = ROOT modifier = faction_displeased multiplier = 8 years = 6 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_decrease" value = 9 } } }
					opinion = { who = ROOT modifier = faction_displeased multiplier = 9 years = 6 }
				}
				if = {
					limit = { PREV = { is_variable_equal = { which = "faction_mood_decrease" value = 10 } } }
					opinion = { who = ROOT modifier = faction_displeased multiplier = 10 years = 6 }
				}
			}
			set_variable = { which = "faction_mood_increase" value = 0 }
			set_variable = { which = "faction_mood_decrease" value = 0 }
		}
		
		#for the annual faction maintenance, add in any yearly faction opinion modifiers & calculate faction leader popularity
		if = {
			limit = { has_character_flag = annual_faction_maintenance }
			clr_character_flag = annual_faction_maintenance

			#crown authority
			any_vassal = {
				remove_opinion = { who = ROOT modifier = faction_approve_CA }
				remove_opinion = { who = ROOT modifier = faction_disapprove_CA }
			}
			if = {
				limit = {
					higher_real_tier_than = DUKE
					primary_title = { crownlaw_title = { has_law = crown_authority_0 } }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_approve_CA months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_CA months = 14 }
				}
			}
			if = {
				limit = {
					higher_real_tier_than = DUKE
					primary_title = {
						crownlaw_title = { has_law = crown_authority_1 }
						NOT = { title = e_hre }
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_CA months = 14 }
				}
			}
			if = {
				limit = {
					higher_real_tier_than = DUKE
					primary_title = {
						crownlaw_title = { has_law = crown_authority_1 }
						title = e_hre
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_CA multiplier = 2 months = 14 }
				}
			}
			if = {
				limit = {
					higher_real_tier_than = DUKE
					primary_title = {
						crownlaw_title = { has_law = crown_authority_2 }
						NOT = { title = e_hre }
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_CA months = 14 }
				}
			}
			if = {
				limit = {
					higher_real_tier_than = DUKE
					primary_title = {
						crownlaw_title = { has_law = crown_authority_2 }
						title = e_hre
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_CA months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_CA multiplier = 3 months = 14 }
				}
			}
			if = {
				limit = {
					higher_real_tier_than = DUKE
					primary_title = {
						crownlaw_title = { has_law = crown_authority_3 }
						NOT = { title = e_hre }
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_CA multiplier = 2 months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_approve_CA months = 14 }
				}
			}
			if = {
				limit = {
					higher_real_tier_than = DUKE
					primary_title = {
						crownlaw_title = { has_law = crown_authority_3 }
						title = e_hre
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_CA multiplier = 2 months = 14 }
				}				
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_CA multiplier = 4 months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_approve_CA months = 14 }
				}
			}
			if = {
				limit = {
					higher_real_tier_than = DUKE
					primary_title = {
						crownlaw_title = { has_law = crown_authority_4 }
						NOT = { title = e_hre }
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_CA multiplier = 3 months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_approve_CA multiplier = 2 months = 14 }
				}
			}
			if = {
				limit = {
					higher_real_tier_than = DUKE
					primary_title = {
						crownlaw_title = { has_law = crown_authority_2 }
						title = e_hre
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_CA multiplier = 5 months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_CA multiplier = 3 months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_approve_CA multiplier = 2 months = 14 }
				}
			}

			#tribal organization
			any_vassal = {
				remove_opinion = { who = ROOT modifier = faction_approve_TO }
				remove_opinion = { who = ROOT modifier = faction_disapprove_TO }
			}
			if = {
				limit = {
					primary_title = { crownlaw_title = { has_law = tribal_organization_0 } }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_approve_TO months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_TO months = 14 }
				}
			}
			if = {
				limit = {
					primary_title = { crownlaw_title = { has_law = tribal_organization_1 } }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_TO months = 14 }
				}
			}
			if = {
				limit = {
					primary_title = { crownlaw_title = { has_law = tribal_organization_2 } }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_TO months = 14 }
				}
			}
			if = {
				limit = {
					primary_title = { crownlaw_title = { has_law = tribal_organization_3 } }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_TO multiplier = 2 months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_TO months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_approve_TO months = 14 }
				}
			}
			if = {
				limit = {
					primary_title = { crownlaw_title = { has_law = tribal_organization_4 } }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_TO multiplier = 3 months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_TO months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_approve_TO multiplier = 2 months = 14 }
				}
			}							

			#feudal/city/temple/iqta tax
			any_vassal = {
				remove_opinion = { who = ROOT modifier = faction_disapprove_taxes }
			}
			if = {
				limit = { primary_title = { has_law = feudal_tax_1 } }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_taxes months = 14 }
				}
			}
			if = {
				limit = { primary_title = { has_law = feudal_tax_2 } }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_taxes multiplier = 2 months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_taxes months = 14 }
				}
			}
			if = {
				limit = { primary_title = { has_law = city_tax_1 } }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_taxes months = 14 }
				}
			}
			if = {
				limit = { primary_title = { has_law = city_tax_2 } }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_taxes multiplier = 2 months = 14 }
				}
			}
			if = {
				limit = { primary_title = { has_law = temple_tax_1 } }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_taxes months = 14 }
				}
			}
			if = {
				limit = { primary_title = { has_law = temple_tax_2 } }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_taxes multiplier = 2 months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_taxes months = 14 }
				}
			}
			if = {
				limit = { primary_title = { has_law = iqta_tax_1 } }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_taxes months = 14 }
				}
			}
			if = {
				limit = { primary_title = { has_law = iqta_tax_2 } }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_taxes multiplier = 2 months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_taxes months = 14 }
				}
			}

			#tax privileges
			any_vassal = {
				remove_opinion = { who = ROOT modifier = faction_approve_tax_privilege }
				remove_opinion = { who = ROOT modifier = faction_disapprove_tax_privilege }
			}
			if = {
				limit = { primary_title = { has_law = tax_privileges_0 } }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_tax_privilege months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_tax_privilege months = 14 }
				}
			}
			if = {
				limit = { primary_title = { has_law = tax_privileges_2 } }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_approve_tax_privilege months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_approve_tax_privilege months = 14 }
				}
			}

			#levy privileges
			any_vassal = {
				remove_opinion = { who = ROOT modifier = faction_approve_levy_privilege }
				remove_opinion = { who = ROOT modifier = faction_disapprove_levy_privilege }
			}
			if = {
				limit = { primary_title = { has_law = levy_privileges_1 } }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					opinion = { who = ROOT modifier = faction_approve_levy_privilege months = 14 }
				}
			}
			if = {
				limit = { primary_title = { has_law = levy_privileges_0 } }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_levy_privilege months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_levy_privilege multiplier = 2 months = 14 }
				}
			}

			#council terms
			any_vassal = {
				remove_opinion = { who = ROOT modifier = faction_approve_council_term }
			}
			if = {
				limit = { primary_title = { has_law = council_privileges_1 } }
				job_chancellor = {
					remove_opinion = { who = ROOT modifier = grateful_council_term }
					opinion = { who = ROOT modifier = grateful_council_term months = 14 }
				}
				job_marshal = {
					remove_opinion = { who = ROOT modifier = grateful_council_term }
					opinion = { who = ROOT modifier = grateful_council_term months = 14 }
				}
				job_treasurer = {
					remove_opinion = { who = ROOT modifier = grateful_council_term }
					opinion = { who = ROOT modifier = grateful_council_term months = 14 }
				}
				job_spymaster = {
					remove_opinion = { who = ROOT modifier = grateful_council_term }
					opinion = { who = ROOT modifier = grateful_council_term months = 14 }
				}
				job_spiritual = {
					remove_opinion = { who = ROOT modifier = grateful_council_term }
					opinion = { who = ROOT modifier = grateful_council_term months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_approve_council_term months = 14 }
				}
			}
			
			#councillors
			any_vassal = {
				remove_opinion = { who = ROOT modifier = faction_approve_council }
				remove_opinion = { who = ROOT modifier = faction_disapprove_council }
			}
			if = {
				limit = {
					any_courtier = {
						is_councillor = yes
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_approve_council months = 14 }
				}
			}
			if = {
				limit = {
					NOT = {
						any_courtier = {
							is_councillor = yes
							OR = {
								leads_faction = faction_court
								in_faction = faction_court
							}
						}
					}
				}
				any_vassal = {
					limit = {
						is_councillor = no
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_council months = 14 }
				}
			}
			if = {
				limit = {
					job_treasurer = {
						NOR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
				}
				any_vassal = {
					limit = {
						is_councillor = no
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_council months = 14 }
				}
			}
			if = {
				limit = {
					job_treasurer = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_approve_council months = 14 }
				}
			}
			if = {
				limit = {
					job_marshal = {
						NOR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
				}
				any_vassal = {
					limit = {
						is_councillor = no
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_council months = 14 }
				}
			}
			if = {
				limit = {
					job_marshal = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					opinion = { who = ROOT modifier = faction_approve_council months = 14 }
				}
			}
			if = {
				limit = {
					job_spiritual = {
						NOR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
				}
				any_vassal = {
					limit = {
						is_councillor = no
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_council months = 14 }
				}
			}
			if = {
				limit = {
					job_spiritual = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_approve_council months = 14 }
				}
			}

			#piety
			any_vassal = {
				remove_opinion = { who = ROOT modifier = faction_approve_piety }
				remove_opinion = { who = ROOT modifier = faction_disapprove_piety }
			}
			if = {
				limit = {
					NOR = {
						piety = 0
						any_war = {
							OR = {
								using_cb = crusade
								using_cb = holy_war
							}
							attacker = { character = ROOT }
						}
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_piety multiplier = 2 months = 14 }
				}
			}
			if = {
				limit = {
					piety = 500
					NOT = { piety = 1000 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_approve_piety months = 14 }
				}
			}
			if = {
				limit = { piety = 1000 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_approve_piety multiplier = 2 months = 14 }
				}
			}
			if = {
				limit = {
					any_war = {
						OR = {
							using_cb = crusade
							using_cb = holy_war
						}
						attacker = { character = ROOT }
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_approve_piety multiplier = 2 months = 14 }
				}
			}

			#debt/wealth
			any_vassal = {
				remove_opinion = { who = ROOT modifier = faction_disapprove_debt }
				remove_opinion = { who = ROOT modifier = faction_approve_wealth }
			}
			if = {
				limit = {
					OR = {
						NOT = { wealth = 0 }
						has_character_flag = loan_taken
					}
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_debt multiplier = 2 months = 14 }
				}
			}
			if = {
				limit = {
					scaled_wealth = 2.5
					NOT = { scaled_wealth = 5.0 }
					NOT = { has_character_flag = loan_taken }
					NOT = { check_variable = { which = "loan_amount" value = 49.5 } }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_approve_wealth months = 14 }
				}
			}
			if = {
				limit = {
					scaled_wealth = 5.0
					NOT = { has_character_flag = loan_taken }
					NOT = { check_variable = { which = "loan_amount" value = 49.5 } }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_approve_wealth multiplier = 2 months = 14 }
				}
			}

			#prestige
			any_vassal = {
				remove_opinion = { who = ROOT modifier = faction_approve_prestige }
				remove_opinion = { who = ROOT modifier = faction_disapprove_prestige }
			}
			if = {
				limit = { NOT = { prestige = 0 } }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_prestige multiplier = 2 months = 14 }
				}
			}
			if = {
				limit = {
					prestige = 1000
					NOT = { prestige = 2500 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					opinion = { who = ROOT modifier = faction_approve_prestige months = 14 }
				}
			}
			if = {
				limit = {
					prestige = 2500
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					opinion = { who = ROOT modifier = faction_approve_prestige multiplier = 2 months = 14 }
				}
			}

			#peace
			any_vassal = {
				remove_opinion = { who = ROOT modifier = faction_approve_peace }
				remove_opinion = { who = ROOT modifier = faction_disapprove_peace }
			}
			if = {
				limit = {
					check_variable = { which = "years_of_peace" value = 5 }
					NOT = { check_variable = { which = "years_of_peace" value = 10 } }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_approve_peace months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_peace months = 14 }
				}
			}
			if = {
				limit = {
					check_variable = { which = "years_of_peace" value = 10 }
					NOT = { check_variable = { which = "years_of_peace" value = 20 } }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_approve_peace multiplier = 2 months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_peace multiplier = 2 months = 14 }
				}
			}
			if = {
				limit = {
					check_variable = { which = "years_of_peace" value = 20 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					opinion = { who = ROOT modifier = faction_approve_peace multiplier = 4 months = 14 }
				}
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_peace multiplier = 4 months = 14 }
				}
			}

			#decadence
			any_vassal = {
				remove_opinion = { who = ROOT modifier = faction_disapprove_decadence }
			}
			if = {
				limit = {
					religion_group = muslim
					decadence = 25
					NOT = { decadence = 50 }
				}
				any_vassal = {
					limit = {
						NOR = {
							trait = decadent
							trait = cynical
						}
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_decadence multiplier = 3 months = 14 }
				}
				any_vassal = {
					limit = {
						NOR = {
							trait = decadent
							trait = cynical
						}
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_decadence multiplier = 2 months = 14 }
				}
				any_vassal = {
					limit = {
						NOR = {
							trait = decadent
							trait = cynical
						}
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_decadence months = 14 }
				}
			}
			if = {
				limit = {
					religion_group = muslim
					decadence = 50
					NOT = { decadence = 75 }
				}
				any_vassal = {
					limit = {
						NOR = {
							trait = decadent
							trait = cynical
						}
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_decadence multiplier = 4 months = 14 }
				}
				any_vassal = {
					limit = {
						NOR = {
							trait = decadent
							trait = cynical
						}
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_decadence multiplier = 3 months = 14 }
				}
				any_vassal = {
					limit = {
						NOR = {
							trait = decadent
							trait = cynical
						}
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_decadence multiplier = 2 months = 14 }
				}
			}
			if = {
				limit = {
					religion_group = muslim
					decadence = 75
				}
				any_vassal = {
					limit = {
						NOR = {
							trait = decadent
							trait = cynical
						}
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_decadence multiplier = 5 months = 14 }
				}
				any_vassal = {
					limit = {
						NOR = {
							trait = decadent
							trait = cynical
						}
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_decadence multiplier = 4 months = 14 }
				}
				any_vassal = {
					limit = {
						NOR = {
							trait = decadent
							trait = cynical
						}
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					opinion = { who = ROOT modifier = faction_disapprove_decadence multiplier = 3 months = 14 }
				}
			}
			
			#adjust moods of factions towards their leaders, based on agreement over opinion of liege
			any_vassal = {
				limit = {
					OR = {
						leads_faction = faction_court
						leads_faction = faction_prosperity
						leads_faction = faction_glory
						leads_faction = faction_tradition
					}
				}
				ROOT = {
					any_vassal = {
						remove_opinion = { who = PREVPREV modifier = faction_agree_liege }
						remove_opinion = { who = PREVPREV modifier = faction_disagree_liege }
					}
				}
				if = {
					limit = {
						NOT = { opinion = { who = ROOT value = -75 } }
					}
					ROOT = {
						any_vassal = {
							limit = {
								OR = {
									AND = {
										in_faction = faction_court
										PREVPREV = { leads_faction = faction_court }
									}
									AND = {
										in_faction = faction_prosperity
										PREVPREV = { leads_faction = faction_prosperity }
									}
									AND = {
										in_faction = faction_glory
										PREVPREV = { leads_faction = faction_glory }
									}
									AND = {
										in_faction = faction_tradition
										PREVPREV = { leads_faction = faction_tradition }
									}
								}
							}
							if = {
								limit = {
									NOT = { opinion = { who = ROOT value = -75 } }
								}
								opinion = { who = PREVPREV modifier = faction_agree_liege months = 14 }
							}
							if = {
								limit = {
									opinion = { who = ROOT value = -25 }
									NOT = { opinion = { who = ROOT value = 25 } }
								}
								opinion = { who = PREVPREV modifier = faction_disagree_liege months = 14 }
							}
							if = {
								limit = {
									opinion = { who = ROOT value = 25 }
									NOT = { opinion = { who = ROOT value = 75 } }
								}
								opinion = { who = PREVPREV modifier = faction_disagree_liege multiplier = 2 months = 14 }
							}
							if = {
								limit = {
									opinion = { who = ROOT value = 75 }
								}
								opinion = { who = PREVPREV modifier = faction_disagree_liege multiplier = 3 months = 14 }
							}
						}
					}
				}
				if = {
					limit = {
						opinion = { who = ROOT value = -75 }
						NOT = { opinion = { who = ROOT value = -25 } }
					}
					ROOT = {
						any_vassal = {
							limit = {
								OR = {
									AND = {
										in_faction = faction_court
										PREVPREV = { leads_faction = faction_court }
									}
									AND = {
										in_faction = faction_prosperity
										PREVPREV = { leads_faction = faction_prosperity }
									}
									AND = {
										in_faction = faction_glory
										PREVPREV = { leads_faction = faction_glory }
									}
									AND = {
										in_faction = faction_tradition
										PREVPREV = { leads_faction = faction_tradition }
									}
								}
							}
							if = {
								limit = {
									opinion = { who = ROOT value = -75 }
									NOT = { opinion = { who = ROOT value = -25 } }
								}
								opinion = { who = PREVPREV modifier = faction_agree_liege months = 14 }
							}
							if = {
								limit = {
									opinion = { who = ROOT value = 25 }
									NOT = { opinion = { who = ROOT value = 75 } }
								}
								opinion = { who = PREVPREV modifier = faction_disagree_liege months = 14 }
							}
							if = {
								limit = {
									opinion = { who = ROOT value = 75 }
								}
								opinion = { who = PREVPREV modifier = faction_disagree_liege multiplier = 2 months = 14 }
							}
						}
					}
				}
				if = {
					limit = {
						opinion = { who = ROOT value = -25 }
						NOT = { opinion = { who = ROOT value = 25 } }
					}
					ROOT = {
						any_vassal = {
							limit = {
								OR = {
									AND = {
										in_faction = faction_court
										PREVPREV = { leads_faction = faction_court }
									}
									AND = {
										in_faction = faction_prosperity
										PREVPREV = { leads_faction = faction_prosperity }
									}
									AND = {
										in_faction = faction_glory
										PREVPREV = { leads_faction = faction_glory }
									}
									AND = {
										in_faction = faction_tradition
										PREVPREV = { leads_faction = faction_tradition }
									}
								}
							}
							if = {
								limit = {
									NOT = { opinion = { who = ROOT value = -75 } }
								}
								opinion = { who = PREVPREV modifier = faction_disagree_liege months = 14 }
							}
							if = {
								limit = {
									opinion = { who = ROOT value = -25 }
									NOT = { opinion = { who = ROOT value = 25 } }
								}
								opinion = { who = PREVPREV modifier = faction_agree_liege months = 14 }
							}
							if = {
								limit = {
									opinion = { who = ROOT value = 75 }
								}
								opinion = { who = PREVPREV modifier = faction_disagree_liege months = 14 }
							}
						}
					}
				}
				if = {
					limit = {
						opinion = { who = ROOT value = 25 }
						NOT = { opinion = { who = ROOT value = 75 } }
					}
					ROOT = {
						any_vassal = {
							limit = {
								OR = {
									AND = {
										in_faction = faction_court
										PREVPREV = { leads_faction = faction_court }
									}
									AND = {
										in_faction = faction_prosperity
										PREVPREV = { leads_faction = faction_prosperity }
									}
									AND = {
										in_faction = faction_glory
										PREVPREV = { leads_faction = faction_glory }
									}
									AND = {
										in_faction = faction_tradition
										PREVPREV = { leads_faction = faction_tradition }
									}
								}
							}
							if = {
								limit = {
									NOT = { opinion = { who = ROOT value = -75 } }
								}
								opinion = { who = PREVPREV modifier = faction_disagree_liege multiplier = 2 months = 14 }
							}
							if = {
								limit = {
									opinion = { who = ROOT value = -75 }
									NOT = { opinion = { who = ROOT value = -25 } }
								}
								opinion = { who = PREVPREV modifier = faction_disagree_liege months = 14 }
							}
							if = {
								limit = {
									opinion = { who = ROOT value = 25 }
									NOT = { opinion = { who = ROOT value = 75 } }
								}
								opinion = { who = PREVPREV modifier = faction_agree_liege months = 14 }
							}
						}
					}
				}
				if = {
					limit = {
						opinion = { who = ROOT value = 75 }
					}
					ROOT = {
						any_vassal = {
							limit = {
								OR = {
									AND = {
										in_faction = faction_court
										PREVPREV = { leads_faction = faction_court }
									}
									AND = {
										in_faction = faction_prosperity
										PREVPREV = { leads_faction = faction_prosperity }
									}
									AND = {
										in_faction = faction_glory
										PREVPREV = { leads_faction = faction_glory }
									}
									AND = {
										in_faction = faction_tradition
										PREVPREV = { leads_faction = faction_tradition }
									}
								}
							}
							if = {
								limit = {
									NOT = { opinion = { who = ROOT value = -75 } }
								}
								opinion = { who = PREVPREV modifier = faction_disagree_liege multiplier = 3 months = 14 }
							}
							if = {
								limit = {
									opinion = { who = ROOT value = -75 }
									NOT = { opinion = { who = ROOT value = -25 } }
								}
								opinion = { who = PREVPREV modifier = faction_disagree_liege multiplier = 2 months = 14 }
							}
							if = {
								limit = {
									opinion = { who = ROOT value = -25 }
									NOT = { opinion = { who = ROOT value = 25 } }
								}
								opinion = { who = PREVPREV modifier = faction_disagree_liege months = 14 }
							}
							if = {
								limit = {
									opinion = { who = ROOT value = 75 }
								}
								opinion = { who = PREVPREV modifier = faction_agree_liege months = 14 }
							}
						}
					}
				}
			}
		}
		
		#evaluate faction moods
		any_vassal = {
			limit = {
				OR = {
					leads_faction = faction_court
					leads_faction = faction_prosperity
					leads_faction = faction_glory
					leads_faction = faction_tradition
					in_faction = faction_court
					in_faction = faction_prosperity
					in_faction = faction_glory
					in_faction = faction_tradition
				}
			}
			#first reset the variable for the individual faction member
			ROOT = { set_variable = { which = "faction_member_approval" value = 0 } }
			#then add a number based on their opinion of the liege (from 1 to 100, 100 being the best)
			if = {
				limit = {
					opinion = { who = ROOT value = 75 }
				}
				ROOT = { change_variable = { which = "faction_member_approval" value = 100 } }
			}
			if = {
				limit = {
					NOT = { opinion = { who = ROOT value = 75 } }
					opinion = { who = ROOT value = 50 }
				}
				ROOT = { change_variable = { which = "faction_member_approval" value = 87.5 } }
			}
			if = {
				limit = {
					NOT = { opinion = { who = ROOT value = 50 } }
					opinion = { who = ROOT value = 25 }
				}
				ROOT = { change_variable = { which = "faction_member_approval" value = 75 } }
			}
			if = {
				limit = {
					NOT = { opinion = { who = ROOT value = 25 } }
					opinion = { who = ROOT value = 0 }
				}
				ROOT = { change_variable = { which = "faction_member_approval" value = 62.5 } }
			}
			if = {
				limit = {
					NOT = { opinion = { who = ROOT value = 0 } }
					opinion = { who = ROOT value = -25 }
				}
				ROOT = { change_variable = { which = "faction_member_approval" value = 50 } }
			}
			if = {
				limit = {
					NOT = { opinion = { who = ROOT value = -25 } }
					opinion = { who = ROOT value = -50 }
				}
				ROOT = { change_variable = { which = "faction_member_approval" value = 37.5 } }
			}
			if = {
				limit = {
					NOT = { opinion = { who = ROOT value = -50 } }
					opinion = { who = ROOT value = -75 }
				}
				ROOT = { change_variable = { which = "faction_member_approval" value = 25 } }
			}
			if = {
				limit = {
					NOT = { opinion = { who = ROOT value = -75 } }
					opinion = { who = ROOT value = -99 }
				}
				ROOT = { change_variable = { which = "faction_member_approval" value = 12.5 } }
			}
			if = {
				limit = {
					NOT = { opinion = { who = ROOT value = -99 } }
				}
				ROOT = { change_variable = { which = "faction_member_approval" value = 1 } }
			}
			#then multiply that number by the number of votes they have in the faction
			if = {
				limit = { real_tier = COUNT }
				ROOT = { multiply_variable = { which = "faction_member_approval" value = 2 } }
			}
			if = {
				limit = { real_tier = DUKE }
				ROOT = { multiply_variable = { which = "faction_member_approval" value = 4 } }
			}
			if = {
				limit = { real_tier = KING }
				ROOT = { multiply_variable = { which = "faction_member_approval" value = 8 } }
			}
			#then divide by the total number of votes in the faction and add that to the liege's mood variable
			if = {
				limit = {
					OR = {
						leads_faction = faction_court
						in_faction = faction_court
					}
				}
				ROOT = {
					divide_variable = { which = "faction_member_approval" which = "faction_votes_court" }
					change_variable = { which = "faction_mood_court" which = "faction_member_approval" }
				}
			}
			if = {
				limit = {
					OR = {
						leads_faction = faction_prosperity
						in_faction = faction_prosperity
					}
				}
				ROOT = {
					divide_variable = { which = "faction_member_approval" which = "faction_votes_prosperity" }
					change_variable = { which = "faction_mood_prosperity" which = "faction_member_approval" }
				}
			}
			if = {
				limit = {
					OR = {
						leads_faction = faction_glory
						in_faction = faction_glory
					}
				}
				ROOT = {
					divide_variable = { which = "faction_member_approval" which = "faction_votes_glory" }
					change_variable = { which = "faction_mood_glory" which = "faction_member_approval" }
				}
			}
			if = {
				limit = {
					OR = {
						leads_faction = faction_tradition
						in_faction = faction_tradition
					}
				}
				ROOT = {
					divide_variable = { which = "faction_member_approval" which = "faction_votes_tradition" }
					change_variable = { which = "faction_mood_tradition" which = "faction_member_approval" }
				}
			}
		}
		if = {
			limit = {
				any_vassal = {
					OR = {
						leads_faction = faction_court
						in_faction = faction_court
					}
				}
			}
			#when mood variable puts the faction into a new mood category, change the flag
			if = {
				limit = {
					check_variable = { which = "faction_mood_court" value = 75 }
					NOT = { has_character_flag = faction_court_happy }
				}
				set_character_flag = faction_court_happy
				clr_character_flag = faction_court_unhappy
				clr_character_flag = faction_court_angry
				character_event = { id = PlusFaction.201 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					character_event = { id = PlusFaction.201 days = 1 }
				}
			}
			if = {
				limit = {
					NOT = { check_variable = { which = "faction_mood_court" value = 75 } }
					check_variable = { which = "faction_mood_court" value = 50 }
					OR = {
						has_character_flag = faction_court_happy
						has_character_flag = faction_court_unhappy
						has_character_flag = faction_court_angry
					}	
				}
				clr_character_flag = faction_court_happy
				clr_character_flag = faction_court_unhappy
				clr_character_flag = faction_court_angry
				character_event = { id = PlusFaction.201 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					character_event = { id = PlusFaction.201 days = 1 }
				}
			}				
			if = {
				limit = {
					check_variable = { which = "faction_mood_court" value = 37.5 }
					NOT = { check_variable = { which = "faction_mood_court" value = 50 } }
					NOT = { has_character_flag = faction_court_unhappy }
				}
				set_character_flag = faction_court_unhappy
				clr_character_flag = faction_court_happy
				clr_character_flag = faction_court_angry
				character_event = { id = PlusFaction.201 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					character_event = { id = PlusFaction.201 days = 1 }
				}
			}
			if = {
				limit = {
					NOT = { check_variable = { which = "faction_mood_court" value = 37.5 } }
					NOT = { has_character_flag = faction_court_angry }
				}
				set_character_flag = faction_court_angry
				clr_character_flag = faction_court_unhappy
				clr_character_flag = faction_court_happy
				character_event = { id = PlusFaction.201 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					character_event = { id = PlusFaction.201 days = 1 }
				}
			}
		}
		if = {
			limit = {
				any_vassal = {
					OR = {
						leads_faction = faction_prosperity
						in_faction = faction_prosperity
					}
				}
			}
			#when mood variable puts the faction into a new mood category, change the flag
			if = {
				limit = {
					check_variable = { which = "faction_mood_prosperity" value = 75 }
					NOT = { has_character_flag = faction_prosperity_happy }
				}
				set_character_flag = faction_prosperity_happy
				clr_character_flag = faction_prosperity_unhappy
				clr_character_flag = faction_prosperity_angry
				character_event = { id = PlusFaction.202 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					character_event = { id = PlusFaction.202 days = 1 }
				}
			}
			if = {
				limit = {
					NOT = { check_variable = { which = "faction_mood_prosperity" value = 75 } }
					check_variable = { which = "faction_mood_prosperity" value = 50 }
					OR = {
						has_character_flag = faction_prosperity_happy
						has_character_flag = faction_prosperity_unhappy
						has_character_flag = faction_prosperity_angry
					}	
				}
				clr_character_flag = faction_prosperity_happy
				clr_character_flag = faction_prosperity_unhappy
				clr_character_flag = faction_prosperity_angry
				character_event = { id = PlusFaction.202 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					character_event = { id = PlusFaction.202 days = 1 }
				}
			}
			if = {
				limit = {
					check_variable = { which = "faction_mood_prosperity" value = 37.5 }
					NOT = { check_variable = { which = "faction_mood_prosperity" value = 50 } }
					NOT = { has_character_flag = faction_prosperity_unhappy }
				}
				set_character_flag = faction_prosperity_unhappy
				clr_character_flag = faction_prosperity_happy
				clr_character_flag = faction_prosperity_angry
				character_event = { id = PlusFaction.202 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					character_event = { id = PlusFaction.202 days = 1 }
				}
			}
			if = {
				limit = {
					NOT = { check_variable = { which = "faction_mood_prosperity" value = 37.5 } }
					NOT = { has_character_flag = faction_prosperity_angry }
				}
				set_character_flag = faction_prosperity_angry
				clr_character_flag = faction_prosperity_unhappy
				clr_character_flag = faction_prosperity_happy
				character_event = { id = PlusFaction.202 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					character_event = { id = PlusFaction.202 days = 1 }
				}
			}
		}
		if = {
			limit = {
				any_vassal = {
					OR = {
						leads_faction = faction_glory
						in_faction = faction_glory
					}
				}
			}
			#when mood variable puts the faction into a new mood category, change the flag
			if = {
				limit = {
					check_variable = { which = "faction_mood_glory" value = 75 }
					NOT = { has_character_flag = faction_glory_happy }
				}
				set_character_flag = faction_glory_happy
				clr_character_flag = faction_glory_unhappy
				clr_character_flag = faction_glory_angry
				character_event = { id = PlusFaction.203 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					character_event = { id = PlusFaction.203 days = 1 }
				}
			}
			if = {
				limit = {
					NOT = { check_variable = { which = "faction_mood_glory" value = 75 } }
					check_variable = { which = "faction_mood_glory" value = 50 }
					OR = {
						has_character_flag = faction_glory_happy
						has_character_flag = faction_glory_unhappy
						has_character_flag = faction_glory_angry
					}	
				}
				clr_character_flag = faction_glory_happy
				clr_character_flag = faction_glory_unhappy
				clr_character_flag = faction_glory_angry
				character_event = { id = PlusFaction.203 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					character_event = { id = PlusFaction.203 days = 1 }
				}
			}
			if = {
				limit = {
					check_variable = { which = "faction_mood_glory" value = 37.5 }
					NOT = { check_variable = { which = "faction_mood_glory" value = 50 } }
					NOT = { has_character_flag = faction_glory_unhappy }
				}
				set_character_flag = faction_glory_unhappy
				clr_character_flag = faction_glory_happy
				clr_character_flag = faction_glory_angry
				character_event = { id = PlusFaction.203 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					character_event = { id = PlusFaction.203 days = 1 }
				}
			}
			if = {
				limit = {
					NOT = { check_variable = { which = "faction_mood_glory" value = 37.5 } }
					NOT = { has_character_flag = faction_glory_angry }
				}
				set_character_flag = faction_glory_angry
				clr_character_flag = faction_glory_unhappy
				clr_character_flag = faction_glory_happy
				character_event = { id = PlusFaction.203 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					character_event = { id = PlusFaction.203 days = 1 }
				}
			}
		}
		if = {
			limit = {
				any_vassal = {
					OR = {
						leads_faction = faction_tradition
						in_faction = faction_tradition
					}
				}
			}
			#when mood variable puts the faction into a new mood category, change the flag
			if = {
				limit = {
					check_variable = { which = "faction_mood_tradition" value = 75 }
					NOT = { has_character_flag = faction_tradition_happy }
				}
				set_character_flag = faction_tradition_happy
				clr_character_flag = faction_tradition_unhappy
				clr_character_flag = faction_tradition_angry
				character_event = { id = PlusFaction.204 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					character_event = { id = PlusFaction.204 days = 1 }
				}
			}
			if = {
				limit = {
					NOT = { check_variable = { which = "faction_mood_tradition" value = 75 } }
					check_variable = { which = "faction_mood_tradition" value = 50 }
					OR = {
						has_character_flag = faction_tradition_happy
						has_character_flag = faction_tradition_unhappy
						has_character_flag = faction_tradition_angry
					}	
				}
				clr_character_flag = faction_tradition_happy
				clr_character_flag = faction_tradition_unhappy
				clr_character_flag = faction_tradition_angry
				character_event = { id = PlusFaction.204 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					character_event = { id = PlusFaction.204 days = 1 }
				}
			}
			if = {
				limit = {
					check_variable = { which = "faction_mood_tradition" value = 37.5 }
					NOT = { check_variable = { which = "faction_mood_tradition" value = 50 } }
					NOT = { has_character_flag = faction_tradition_unhappy }
				}
				set_character_flag = faction_tradition_unhappy
				clr_character_flag = faction_tradition_happy
				clr_character_flag = faction_tradition_angry
				character_event = { id = PlusFaction.204 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					character_event = { id = PlusFaction.204 days = 1 }
				}
			}
			if = {
				limit = {
					NOT = { check_variable = { which = "faction_mood_tradition" value = 37.5 } }
					NOT = { has_character_flag = faction_tradition_angry }
				}
				set_character_flag = faction_tradition_angry
				clr_character_flag = faction_tradition_unhappy
				clr_character_flag = faction_tradition_happy
				character_event = { id = PlusFaction.204 days = 1 }
				any_vassal = {
					limit = {
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					character_event = { id = PlusFaction.204 days = 1 }
				}
			}
		}
	}			
}

# Notification of court faction mood change
character_event = {
	id = PlusFaction.201
	picture = GFX_evt_council
	
	is_triggered_only = yes
	notification = yes
	hide_from = yes
	
	desc = {
		text = EVTDESC_PlusFaction_201_Happy
		trigger = {
			FROM = { has_character_flag = faction_court_happy }
		}
	}
	desc = {
		text = EVTDESC_PlusFaction_201_Neutral
		trigger = {
			FROM = {
				NOR = {
					has_character_flag = faction_court_happy
					has_character_flag = faction_court_unhappy
					has_character_flag = faction_court_angry
				}
			}
		}
	}
	desc = {
		text = EVTDESC_PlusFaction_201_Unhappy
		trigger = {
			FROM = { has_character_flag = faction_court_unhappy }
		}
	}
	desc = {
		text = EVTDESC_PlusFaction_201_Angry
		trigger = {
			FROM = { has_character_flag = faction_court_angry }
		}
	}
	
	option = {
		name = "OK"
	}
}

# Notification of prosperity faction mood change
character_event = {
	id = PlusFaction.202
	picture = GFX_evt_council
	
	is_triggered_only = yes
	notification = yes
	hide_from = yes
	
	desc = {
		text = EVTDESC_PlusFaction_202_Happy
		trigger = {
			FROM = { has_character_flag = faction_prosperity_happy }
		}
	}
	desc = {
		text = EVTDESC_PlusFaction_202_Neutral
		trigger = {
			FROM = {
				NOR = {
					has_character_flag = faction_prosperity_happy
					has_character_flag = faction_prosperity_unhappy
					has_character_flag = faction_prosperity_angry
				}
			}
		}
	}
	desc = {
		text = EVTDESC_PlusFaction_202_Unhappy
		trigger = {
			FROM = { has_character_flag = faction_prosperity_unhappy }
		}
	}
	desc = {
		text = EVTDESC_PlusFaction_202_Angry
		trigger = {
			FROM = { has_character_flag = faction_prosperity_angry }
		}
	}
	
	option = {
		name = "OK"
	}
}

# Notification of glory faction mood change
character_event = {
	id = PlusFaction.203
	picture = GFX_evt_council
	
	is_triggered_only = yes
	notification = yes
	hide_from = yes
	
	desc = {
		text = EVTDESC_PlusFaction_203_Happy
		trigger = {
			FROM = { has_character_flag = faction_glory_happy }
		}
	}
	desc = {
		text = EVTDESC_PlusFaction_203_Neutral
		trigger = {
			FROM = {
				NOR = {
					has_character_flag = faction_glory_happy
					has_character_flag = faction_glory_unhappy
					has_character_flag = faction_glory_angry
				}
			}
		}
	}
	desc = {
		text = EVTDESC_PlusFaction_203_Unhappy
		trigger = {
			FROM = { has_character_flag = faction_glory_unhappy }
		}
	}
	desc = {
		text = EVTDESC_PlusFaction_203_Angry
		trigger = {
			FROM = { has_character_flag = faction_glory_angry }
		}
	}
	
	option = {
		name = "OK"
	}
}

# Notification of tradition faction mood change
character_event = {
	id = PlusFaction.204
	picture = GFX_evt_council
	
	is_triggered_only = yes
	notification = yes
	hide_from = yes
	
	desc = {
		text = EVTDESC_PlusFaction_204_Happy
		trigger = {
			FROM = { has_character_flag = faction_tradition_happy }
		}
	}
	desc = {
		text = EVTDESC_PlusFaction_204_Neutral
		trigger = {
			FROM = {
				NOR = {
					has_character_flag = faction_tradition_happy
					has_character_flag = faction_tradition_unhappy
					has_character_flag = faction_tradition_angry
				}
			}
		}
	}
	desc = {
		text = EVTDESC_PlusFaction_204_Unhappy
		trigger = {
			FROM = { has_character_flag = faction_tradition_unhappy }
		}
	}
	desc = {
		text = EVTDESC_PlusFaction_204_Angry
		trigger = {
			FROM = { has_character_flag = faction_tradition_angry }
		}
	}
	
	option = {
		name = "OK"
	}
}

# Faction maintenance on character death
character_event = {
	id = PlusFaction.205

	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		is_ruler = yes
	}

	immediate = {
		#pass on proper flags to the heir if currently in a faction revolt
		if = {
			limit = { has_character_flag = faction_court_war }
			current_heir = { set_character_flag = faction_court_war }
			clr_character_flag = faction_feudal_war
		}
		if = {
			limit = { has_character_flag = faction_prosperity_war }
			current_heir = { set_character_flag = faction_prosperity_war }
			clr_character_flag = faction_court_war
		}
		if = {
			limit = { has_character_flag = faction_glory_war }
			current_heir = { set_character_flag = faction_glory_war }
			clr_character_flag = faction_republican_war
		}
		if = {
			limit = { has_character_flag = faction_tradition_war }
			current_heir = { set_character_flag = faction_tradition_war }
			clr_character_flag = faction_religious_war
		}
		if = {
			limit = { has_character_flag = faction_separatist_war }
			current_heir = { set_character_flag = faction_separatist_war }
			clr_character_flag = faction_separatist_war
		}
		if = {
			limit = { has_character_flag = faction_pretender_war }
			current_heir = { set_character_flag = faction_pretender_war }
			clr_character_flag = faction_pretender_war
		}
		if = {
			limit = { has_character_flag = faction_religious_war }
			current_heir = { set_character_flag = faction_religious_war }
			clr_character_flag = faction_religious_war
		}
		#pass down laws if the heir is inheriting a new primary title
		if = {
			limit = {
				current_heir = { lower_tier_than = ROOT }
			}
			if = {
				limit = { NOT = { has_character_flag = lifetime_appointments } }
				current_heir = { clr_character_flag = lifetime_appointments }
			}
			if = {
				limit = { NOT = { has_character_flag = max_levies }	}
				current_heir = { clr_character_flag = max_levies }
			}
			if = {
				limit = { has_character_flag = lifetime_appointments }
				job_spymaster = { remove_title = job_spymaster remove_opinion = { who = PREV modifier = opinion_fired_from_council } }
				job_marshal = { remove_title = job_marshal remove_opinion = { who = PREV modifier = opinion_fired_from_council } }
				job_chancellor = { remove_title = job_chancellor remove_opinion = { who = PREV modifier = opinion_fired_from_council } }
				job_treasurer = { remove_title = job_treasurer remove_opinion = { who = PREV modifier = opinion_fired_from_council } }
				job_spiritual = { remove_title = job_spiritual remove_opinion = { who = PREV modifier = opinion_fired_from_council } }
				current_heir = {
					set_character_flag = lifetime_appointments
					if = {
						limit = { is_ruler = yes }
						job_spymaster = { remove_title = job_spymaster remove_opinion = { who = PREV modifier = opinion_fired_from_council } }
						job_marshal = { remove_title = job_marshal remove_opinion = { who = PREV modifier = opinion_fired_from_council } }
						job_chancellor = { remove_title = job_chancellor remove_opinion = { who = PREV modifier = opinion_fired_from_council } }
						job_treasurer = { remove_title = job_treasurer remove_opinion = { who = PREV modifier = opinion_fired_from_council } }
						job_spiritual = { remove_title = job_spiritual remove_opinion = { who = PREV modifier = opinion_fired_from_council } }
					}
				}
				clr_character_flag = lifetime_appointments
			}
			if = {
				limit = { has_character_flag = max_levies }
				current_heir = { set_character_flag = max_levies }
				clr_character_flag = max_levies
			}
		}
		#update traits if the heir is not currently part of an ongoing civil war
		if = {
			limit = {
				trait = rebel
				current_heir = {
					NOR = {
						trait = loyalist
						trait = neutral
						trait = rebel
					}
				}
			}
			current_heir = { add_trait = rebel }
			any_opinion_modifier_target = {
				limit = {
					reverse_has_opinion_modifier = { who = ROOT modifier = revolting_against }
				}
				ROOT = {
					current_heir = {
						opinion = { who = PREVPREV modifier = revolting_against years = 100 }
					}
					remove_opinion = { who = PREV modifier = revolting_against }
				}
			}
			remove_trait = rebel
		}
		#update opinions of rebels who are now rebelling against the heir
		current_heir = {
			ROOT = {
				any_realm_character = {
					limit = { has_opinion_modifier = { who = ROOT modifier = revolting_against } }
					opinion = { who = PREVPREV modifier = revolting_against years = 100 }
					remove_opinion = { who = ROOT modifier = revolting_against }
				}
				any_independent_ruler = {
					if = {
						limit = { has_opinion_modifier = { who = ROOT modifier = revolting_against } }
						opinion = { who = PREVPREV modifier = revolting_against years = 100 }
						remove_opinion = { who = ROOT modifier = revolting_against }
					}
					any_realm_character = {
						limit = { has_opinion_modifier = { who = ROOT modifier = revolting_against } }
						opinion = { who = PREVPREVPREV modifier = revolting_against years = 100 }
						remove_opinion = { who = ROOT modifier = revolting_against }
					}
				}
			}
		}
		#reset faction variables
		current_heir = {
			set_variable = { which = "faction_votes_court" value = 0 }
			set_variable = { which = "faction_votes_prosperity" value = 0 }
			set_variable = { which = "faction_votes_glory" value = 0 }
			set_variable = { which = "faction_votes_tradition" value = 0 }
			set_variable = { which = "faction_mood_court" value = 0 }
			set_variable = { which = "faction_mood_prosperity" value = 0 }
			set_variable = { which = "faction_mood_glory" value = 0 }
			set_variable = { which = "faction_mood_tradition" value = 0 }
			clr_character_flag = faction_court_happy
			clr_character_flag = faction_court_unhappy
			clr_character_flag = faction_court_angry
			clr_character_flag = faction_prosperity_happy
			clr_character_flag = faction_prosperity_unhappy
			clr_character_flag = faction_prosperity_angry
			clr_character_flag = faction_glory_happy
			clr_character_flag = faction_glory_unhappy
			clr_character_flag = faction_glory_angry
			clr_character_flag = faction_tradition_happy
			clr_character_flag = faction_tradition_unhappy
			clr_character_flag = faction_tradition_angry
		}
		if = {
			limit = { has_character_flag = faction_court_happy }
			current_heir = { set_character_flag = faction_court_happy }
		}
		if = {
			limit = { has_character_flag = faction_court_unhappy }
			current_heir = { set_character_flag = faction_court_unhappy }
		}
		if = {
			limit = { has_character_flag = faction_court_angry }
			current_heir = { set_character_flag = faction_court_angry }
		}
		if = {
			limit = { has_character_flag = faction_prosperity_happy }
			current_heir = { set_character_flag = faction_prosperity_happy }
		}
		if = {
			limit = { has_character_flag = faction_prosperity_unhappy }
			current_heir = { set_character_flag = faction_prosperity_unhappy }
		}
		if = {
			limit = { has_character_flag = faction_prosperity_angry }
			current_heir = { set_character_flag = faction_prosperity_angry }
		}
		if = {
			limit = { has_character_flag = faction_glory_happy }
			current_heir = { set_character_flag = faction_glory_happy }
		}
		if = {
			limit = { has_character_flag = faction_glory_unhappy }
			current_heir = { set_character_flag = faction_glory_unhappy }
		}
		if = {
			limit = { has_character_flag = faction_glory_angry }
			current_heir = { set_character_flag = faction_glory_angry }
		}
		if = {
			limit = { has_character_flag = faction_tradition_happy }
			current_heir = { set_character_flag = faction_tradition_happy }
		}
		if = {
			limit = { has_character_flag = faction_tradition_unhappy }
			current_heir = { set_character_flag = faction_tradition_unhappy }
		}
		if = {
			limit = { has_character_flag = faction_tradition_angry }
			current_heir = { set_character_flag = faction_tradition_angry }
		}
	}
}

# Faction pleased due to granted title
character_event = {
	id = PlusFaction.212
	
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		FROM = {
			save_event_target_as = new_title
			holder_scope = { save_event_target_as = new_owner }
		}
		event_target:new_title = {
			any_claimant = {
				limit = {
					NOR = {
						character = ROOT
						character = event_target:new_owner
						is_close_relative = event_target:new_owner
					}
					OR = {
						AND = {
							is_female = no
							ROOT = {
								NOR = {
									has_law = enatic_succession
									has_law = enatic_cognatic_succession
								}
							}
						}
						AND = {
							is_female = yes
							ROOT = {
								NOR = {
									has_law = agnatic_succession
									has_law = cognatic_succession
								}
							}
						}
					}
					any_liege = { character = ROOT }
				}
				if = {
					limit = { has_strong_claim = PREV }
					opinion = { who = ROOT modifier = faction_disapprove_title_grant multiplier = 4 years = 10 }
				}
				if = {
					limit = { has_weak_claim = PREV }
					opinion = { who = ROOT modifier = faction_disapprove_title_grant multiplier = 2 years = 10 }
				}
			}
		}
		if = {
			limit = {
				event_target:new_owner = {
					OR = {
						leads_faction = faction_court
						in_faction = faction_court
					}
				}
			}
			ROOT = {
				any_vassal = {
					limit = {
						NOT = { character = event_target:new_owner }
						OR = {
							leads_faction = faction_court
							in_faction = faction_court
						}
					}
					if = {
						limit = { event_target:new_title = { tier = COUNT } }
						opinion = { who = ROOT modifier = faction_approve_title_grant multiplier = 2 years = 3 }
					}
					if = {
						limit = { event_target:new_title = { tier = DUKE } }
						opinion = { who = ROOT modifier = faction_approve_title_grant multiplier = 4 years = 3 }
					}
					if = {
						limit = { event_target:new_title = { tier = KING } }
						opinion = { who = ROOT modifier = faction_approve_title_grant multiplier = 6 years = 3 }
					}
				}
				character_event = { id = PlusFaction.200 days = 1 }
			}
		}
		if = {
			limit = {
				event_target:new_owner = {
					OR = {
						leads_faction = faction_prosperity
						in_faction = faction_prosperity
					}
				}
			}
			ROOT = {
				any_vassal = {
					limit = {
						NOT = { character = event_target:new_owner }
						OR = {
							leads_faction = faction_prosperity
							in_faction = faction_prosperity
						}
					}
					if = {
						limit = { event_target:new_title = { tier = COUNT } }
						opinion = { who = ROOT modifier = faction_approve_title_grant multiplier = 2 years = 3 }
					}
					if = {
						limit = { event_target:new_title = { tier = DUKE } }
						opinion = { who = ROOT modifier = faction_approve_title_grant multiplier = 4 years = 3 }
					}
					if = {
						limit = { event_target:new_title = { tier = KING } }
						opinion = { who = ROOT modifier = faction_approve_title_grant multiplier = 6 years = 3 }
					}
				}
				character_event = { id = PlusFaction.200 days = 1 }
			}
		}
		if = {
			limit = {
				event_target:new_owner = {
					OR = {
						leads_faction = faction_glory
						in_faction = faction_glory
					}
				}
			}
			ROOT = {
				any_vassal = {
					limit = {
						NOT = { character = event_target:new_owner }
						OR = {
							leads_faction = faction_glory
							in_faction = faction_glory
						}
					}
					if = {
						limit = { event_target:new_title = { tier = COUNT } }
						opinion = { who = ROOT modifier = faction_approve_title_grant multiplier = 2 years = 5 }
					}
					if = {
						limit = { event_target:new_title = { tier = DUKE } }
						opinion = { who = ROOT modifier = faction_approve_title_grant multiplier = 4 years = 5 }
					}
					if = {
						limit = { event_target:new_title = { tier = KING } }
						opinion = { who = ROOT modifier = faction_approve_title_grant multiplier = 6 years = 5 }
					}
				}
				character_event = { id = PlusFaction.200 days = 1 }
			}
		}
		if = {
			limit = {
				event_target:new_owner = {
					OR = {
						leads_faction = faction_tradition
						in_faction = faction_tradition
					}
				}
			}
			ROOT = {
				any_vassal = {
					limit = {
						NOT = { character = event_target:new_owner }
						OR = {
							leads_faction = faction_tradition
							in_faction = faction_tradition
						}
					}
					if = {
						limit = { event_target:new_title = { tier = COUNT } }
						opinion = { who = ROOT modifier = faction_approve_title_grant multiplier = 2 years = 5 }
					}
					if = {
						limit = { event_target:new_title = { tier = DUKE } }
						opinion = { who = ROOT modifier = faction_approve_title_grant multiplier = 4 years = 5 }
					}
					if = {
						limit = { event_target:new_title = { tier = KING } }
						opinion = { who = ROOT modifier = faction_approve_title_grant multiplier = 6 years = 5 }
					}
				}
				character_event = { id = PlusFaction.200 days = 1 }
			}
		}
	}
}

